(self.webpackChunkvk=self.webpackChunkvk||[]).push([[85820],{28817:t=>{t.exports={reactions_preview_item:'<div class="ReactionsPreviewItem ReactionsPreviewItem--stackOverlay %class%" style="background-image: url(\'%image_url%\');" aria-label="%title%"></div>'}},19633:(t,e,n)=>{"use strict";n.d(e,{getAnimationAsync:()=>a,onAnimationReady:()=>o,destroyAnimationItem:()=>u,animationModuleLoaderAsync:()=>s});var i=n(70655),r=function(t){var e=t.animationDataGet,n=t.animationDataSet,i=t.loadAnimation;return function(t,r,a){var o=t,u=e?e({animationId:o}):void 0,s=i({animationData:u,animationURL:t,container:r,loadAnimationParams:null==a?void 0:a.loadAnimationParams});return!u&&n&&function(t,e){t.addEventListener("data_ready",(function(){e(t.animationData)}))}(s,(function(t){n({animationId:o,loadedAnimationData:t})})),s}},a=function(t){var e=t.animationDataGet,n=t.animationDataSet,a=t.animationModuleLoader;return function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];return a().then((function(a){var o=a.loadAnimation;return r({animationDataGet:e,animationDataSet:n,loadAnimation:o}).apply(void 0,(0,i.__spreadArray)([],(0,i.__read)(t),!1))}))}};function o(t,e){t.isLoaded?e():t.addEventListener("DOMLoaded",(function(){e()}))}function u(t){var e=function(t){return!t._cbs}(t);e||t.destroy()}var s=function(){return n.e(55489).then(n.bind(n,9499)).then((function(t){return{loadAnimation:(e=t.lottie,function(t){var n,r,a=t.animationData,o=t.animationURL,u=t.container,s=t.loadAnimationParams,c=void 0===s?{}:s,l=a?{animationData:a}:{path:o},d={renderer:"svg",autoplay:null!==(n=null==c?void 0:c.autoplay)&&void 0!==n&&n,loop:null===(r=null==c?void 0:c.loop)||void 0===r||r,rendererSettings:{progressiveLoad:!0}},v=(0,i.__assign)((0,i.__assign)((0,i.__assign)({},l),d),{container:u});return e.loadAnimation(v)})};var e}))}},8271:(t,e,n)=>{"use strict";n.d(e,{HIDE_TOOLTIP_TIMEOUT:()=>i,SHOW_TOOLTIP_TIMEOUT:()=>r,REACTION_ID_DEFAULT:()=>a,REACTION_ID_MAX:()=>o,REACTION_ID_MIN:()=>u,REACTION_ID_UNSET:()=>s,REACTION_SET_ITEMS_MIN_COUNT:()=>c,OPENED_REACTED_USERS_DEFAULT_REACTION_ID:()=>l});var i=600,r=140,a=0,o=7,u=0,s=void 0,c=2,l=a},64746:(t,e,n)=>{"use strict";n.d(e,{isDebugEnabled:()=>a});var i=n(26330),r=void 0,a=function(){return void 0!==r?r:r=!!i.default.get("reactions.debug_enabled")}},14396:(t,e,n)=>{"use strict";n.d(e,{reactionCountsBrandUnwrap:()=>r,reactionCountsBrandWrap:()=>a});var i=n(65594),r=function(t){return(0,i.unwrap)(t)},a=function(t){return(0,i.wrap)(t)}},82701:(t,e,n)=>{"use strict";n.d(e,{reactionLogError:()=>r});var i=n(91525);function r(t){var e=t.error,n=t.reportError;void 0!==n&&n&&(0,i.logError)(e,{environment:"reactions"}),console.error(e)}},17760:(t,e,n)=>{"use strict";n.d(e,{isUnknownObject:()=>s,getReaction:()=>c,getDefaultReaction:()=>l,getDefaultReactionTitle:()=>d,prepareReactionMenuSet:()=>f,isReactionIdSet:()=>m,isReactionIdUnset:()=>_,isValidReactionId:()=>g,parseReactionId:()=>p,parseReactionIdOrUnset:()=>w,validateReactionSetPayloaditems:()=>b,parseReactionMenuConfig:()=>I,calcCounters:()=>S,calcCountersSum:()=>y,calcCountersWeightedSum:()=>R,hasReactionsForCounts:()=>E,counterForReactionId:()=>P,areCountersEqual:()=>A});var i=n(70655),r=n(8271),a=n(14396),o=n(59397),u=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},s=function(t){return null!==t&&"object"==typeof t},c=function(t,e){return t.itemsById[e]},l=function(t){return c(t,r.REACTION_ID_DEFAULT)},d=function(t){var e;return null===(e=l(t))||void 0===e?void 0:e.title},v=function(t,e){return 0===t.length?"":(n=t,i=function(t){return Math.pow(e.width-t.width,2)+Math.pow(e.height-t.height,2)},r=!1,void 0===r&&(r=!0),n.reduce((function(t,e){var n=i(e),a=i(t);return a===n?r?t:e:a<n?t:e}))).url;var n,i,r},f=function(t,e,n){var i=e.map((function(t){var e=t.asset,i=t.color_sets,r=t.id,a=t.score,o=t.title;return{animationURL:e.animation_url||void 0,backgroundColor:null==i?void 0:i.background,id:r,imageMenuURL:v(e.images,n.imageMenuSize),imagePreviewURL:"imagePreviewSize"in n?v(e.images,n.imagePreviewSize):void 0,imageStoryPanelURL:"imageStoryPanelSize"in n?v(e.images,n.imageStoryPanelSize):void 0,imageStoryPreviewURL:"imageStoryPreviewSize"in n?v(e.images,n.imageStoryPreviewSize):void 0,score:a,title:o,titleColor:null==i?void 0:i.foreground}})),r={};return i.forEach((function(t){r[t.id]=t})),{id:t,items:i,itemsById:r}},m=function(t){return t!==r.REACTION_ID_UNSET},_=function(t){return t===r.REACTION_ID_UNSET},g=function(t){return u(t)&&t>=r.REACTION_ID_MIN&&t<=r.REACTION_ID_MAX},p=function(t){var e=parseInt(t,10);return g(e)?{isValid:!0,value:e}:{isValid:!1}},w=function(t){var e=p(t);return e.isValid?e.value:r.REACTION_ID_UNSET},b=function(t,e){if(t.length<r.REACTION_SET_ITEMS_MIN_COUNT)return{error:new Error("Invalid reactions items count in set '"+e+"': "+t.length)}},I=function(t){if(s(t)){var e={},n=t.animationShowStaticAfterEnd,i=t.menuShowDelay,a=t.openedDefaultReactionId,o=t.reportJsErrors;return"number"!=typeof i&&void 0!==i||(e.menuShowDelay=i),"boolean"==typeof n&&(e.animationShowStaticAfterEnd=n),"boolean"==typeof o&&(e.reportJsErrors=o),"number"==typeof a||null===a?null===a?e.openedDefaultReactionId=void 0:g(a)&&(e.openedDefaultReactionId=a):e.openedDefaultReactionId=r.OPENED_REACTED_USERS_DEFAULT_REACTION_ID,e}},S=function(t,e){var n=(0,a.reactionCountsBrandWrap)({});return Object.entries((0,a.reactionCountsBrandUnwrap)(t)).forEach((function(t){var r,a,o,u=(0,i.__read)(t,2),s=u[0],c=u[1],l=s,d=null!==(o=null===(a=null===(r=null==e?void 0:e.itemsById)||void 0===r?void 0:r[l])||void 0===a?void 0:a.score)&&void 0!==o?o:1;n[l]=d*(c||0)})),n},y=function(t){return Object.values((0,a.reactionCountsBrandUnwrap)(t)).reduce((function(t,e){return t+(e||0)}),0)},R=function(t){return y((0,a.reactionCountsBrandWrap)(t))},E=function(t){return y(t)>0},P=function(t,e){var n;return null!==(n=t[e])&&void 0!==n?n:void 0},A=function(t,e){return t&&e?(0,o.isEqual)(t,e):t===e}},65594:(t,e,n)=>{"use strict";n.d(e,{unwrap:()=>i,wrap:()=>r});var i=function(t){return t},r=function(t){return t}},65864:(t,e,n)=>{"use strict";n.d(e,{parseLikeObjectId:()=>r,likePostObjectId:()=>a,likeReplyObjectId:()=>o,getElementLikeButtonCount:()=>u,getElementLikeButtonIcon:()=>s,getElementLikeButtonLabel:()=>c});var i=n(70655);function r(t){var e=t.match(/^([a-z_]+)([0-9\-_]+)$/);if(!e)return null;var n=(0,i.__read)(e,3);return{objectType:n[1],objectId:n[2]}}var a=function(t){return"wall"+t},o=function(t){return"wall_reply"+t},u=function(t){var e;return null!==(e=null==t?void 0:t.querySelector(".like_button_count, ._like_button_count"))&&void 0!==e?e:void 0},s=function(t){var e;return null!==(e=null==t?void 0:t.querySelector(".like_button_icon, ._like_button_icon"))&&void 0!==e?e:void 0},c=function(t){var e;return null!==(e=t.querySelector(".like_button_label, ._like_button_label"))&&void 0!==e?e:void 0}},93682:(t,e,n)=>{"use strict";n.d(e,{ATTR_USER_REACTION_ID:()=>i});var i="data-reaction-user-reaction-id"},1925:(t,e,n)=>{"use strict";n.d(e,{TitleVariantWithLikedUsers:()=>i,TITLE_VARIANT_DEFAULT:()=>r,ReactionMenuTitleVariants:()=>a});var i="WithLikedUsers",r=i,a=[i,"TitleOnly"]},54789:(t,e,n)=>{"use strict";n.d(e,{ButtonStyleVariant:()=>i});var i={Post:"post",Reply:"reply"}},8706:(t,e,n)=>{"use strict";n.d(e,{isVariantInActionStatusBar:()=>r,isVariantHidden:()=>a,previewVisibilityUseCurrent:()=>o,isIntentPreviewInActionStatusBar:()=>u,isIntentPreviewHidden:()=>s,isIntentPreviewUseCurrent:()=>c,previewVisibilityIntentForVariant:()=>l,parsePreviewVariant:()=>d});var i=n(4608),r=function(t){return t===i.PreviewVariantActionStatusBar},a=function(t){return t===i.PreviewVariantHidden},o={kind:"useCurrent"},u=function(t){return t.kind===i.PreviewVariantActionStatusBar},s=function(t){return t.kind===i.PreviewVariantHidden},c=function(t){return"useCurrent"===t.kind},l=function(t){return t?{kind:t}:o},d=function(t){return i.PreviewVariants.includes(t)?t:void 0}},4608:(t,e,n)=>{"use strict";n.d(e,{PreviewVariantActionStatusBar:()=>i,PreviewVariantHidden:()=>r,PreviewVariants:()=>a});var i="action_status_bar",r="hidden",a=[i,r]},95146:(t,e,n)=>{"use strict";n.d(e,{SUPPORTED_OBJECT_TYPES:()=>i,SIZE_32:()=>r,SIZE_40:()=>a,SIZE_96:()=>o,SIZE_128:()=>u,REACTIONS_COUNTS_RESPONSE_FIELD:()=>s,WK_SECTION_PREFIX_REACTIONS:()=>c});var i={wall:"wall",wall_reply:"wall_reply"},r={width:32,height:32},a={width:40,height:40},o={width:96,height:96},u={width:128,height:128},s="reactions_counts",c="reactions"},46346:(t,e,n)=>{"use strict";n.d(e,{animationItemHasData:()=>o,getAnimationAsync:()=>u});var i=n(19633),r=(0,n(66e3).makeSharedState)("reactions-animations-storage",(function(){return{animationItemsData:new Map}}),{version:0}),a=function(){return r().animationItemsData},o=function(t){return a().has(t)},u=(0,i.getAnimationAsync)({animationDataGet:function(t){var e=t.animationId;return a().get(e)},animationDataSet:function(t){var e=t.animationId,n=t.loadedAnimationData;a().set(e,n)},animationModuleLoader:i.animationModuleLoaderAsync})},85207:(t,e,n)=>{"use strict";n.d(e,{isDebugEnabled:()=>i.isDebugEnabled,ENABLED_IN_POST_REPLY:()=>r});var i=n(64746),r=!1},92239:(t,e,n)=>{"use strict";n.d(e,{addDataUpdateListener:()=>o,emitDataUpdate:()=>u,addReactionChooseListener:()=>s,emitReactionChoose:()=>c});var i=n(61508),r=(0,n(66e3).makeSharedState)("reactions-menu-events",(function(){return{emitter:new i.default}}),{version:0}),a=function(){return r().emitter},o=function(t,e){var n,i=a(),r=((n={})[t+":data_update"]=e,n);return i.addListeners(r),function(){i.removeListeners(r)}},u=function(t,e){a().emit(t+":data_update",e)},s=function(t,e){var n,i=a(),r=((n={})[t+":reaction_choose"]=e,n);return i.addListeners(r),function(){i.removeListeners(r)}},c=function(t){a().emit(t+":reaction_choose")}},98306:(t,e,n)=>{"use strict";n.d(e,{getPreviewVariantForLikeBtn:()=>I,reactionsElemPayload:()=>S,shouldReactionsPreviewBeVisible:()=>y,updateReactionsButtonForCounts:()=>P,updateReactionsPreview:()=>E});var i=n(20820),r=n(17760),a=n(35676),o=n(86067),u=n(85667),s=n(72544),c=n(40672),l=n(8706),d=n(70655),v=n(83295),f=n(15544),m=n(28817),_=n.n(m),g=n(54789),p=function(t,e,n,i,a){var o=function(t,e,n){var i,a;void 0===n&&(n=!1);var o=[];try{for(var u=(0,d.__values)(Object.keys(t)),s=u.next();!s.done;s=u.next()){var c=s.value,l=(0,r.parseReactionId)(c);l.isValid&&t[l.value]>0&&o.push(l.value)}}catch(t){i={error:t}}finally{try{s&&!s.done&&(a=u.return)&&a.call(u)}finally{if(i)throw i.error}}return o=o.sort((function(e,n){return(t[n]||0)-(t[e]||0)})).slice(0,e),n&&o.reverse(),o}(e,3),s=t.querySelector(".ReactionsPreview__items"),c=(0,u.getReactionSet)(n),l=0===(0,r.calcCountersSum)(e),m=_().reactions_preview_item;s&&c&&"string"==typeof m?(s.innerHTML=o.map((function(t){var e=c.itemsById[t];if(!e)return"";var n=(0,v.classNames)({"ReactionsPreviewItem--lite ReactionsPreviewItem--stackOverlayLite":a===g.ButtonStyleVariant.Reply,"ReactionsPreviewItem--post ReactionsPreviewItem--stackOverlayPost":a===g.ButtonStyleVariant.Post});return(0,f.rs)(m,{image_url:e.imagePreviewURL,title:e.title,class:n})})).join(""),t.classList.toggle("ReactionsPreview--empty",l),t.classList.toggle("ReactionsPreview--active",void 0!==i)):console.warn("Unable to render reaction previews",{itemsContainer:s,previewItemTemplate:m,reactionSet:c})},w=n(93682),b=function(t){var e=t.getAttribute("data-reaction-counts");if(null===e)return{};var n=e?(0,i.parseJSON)(e):void 0;return"object"==typeof n&&null!==n?n:void 0},I=function(t){var e=t.getAttribute("data-reaction-preview-variant");if(e)return(0,l.parsePreviewVariant)(e)},S=function(t){var e=t.getAttribute("data-reaction-target-object"),n=t.getAttribute("data-reaction-hash"),i=t.getAttribute("data-reaction-set-id");if(null!==i){var a=t.getAttribute(w.ATTR_USER_REACTION_ID),o=a?(0,r.parseReactionIdOrUnset)(a):void 0,u=t.getAttribute("data-reaction-style-variant"),s=u&&(0,c.isValidButtonStyleVariant)(u)?u:void 0,l=t.getAttribute("data-reaction-menu-title-variant"),d=l&&(0,c.isValidButtonTitleVariant)(l)?l:void 0,v=I(t);return{counts:b(t),csrfHash:n,objectRaw:e,reactionSetId:i,styleVariant:s,titleVariant:d,userReactionId:o,previewVariant:v}}},y=function(t){return(0,r.hasReactionsForCounts)(t)},R=function(t,e){var n=e.counts,i=e.countsPrevious,c=e.objectRaw,l=e.reactionId,d=e.reactionSetId,v=e.styleVariant,f=(0,u.getReactionSet)(d),m=(0,r.calcCounters)(n,f),_=(0,r.calcCountersWeightedSum)(m),g=(0,r.calcCountersSum)(n),w=i?(0,r.calcCountersSum)(i):0,b=(0,s.getPreviewElem)(c);b&&(p(b,n,d,l,v),function(t,e,n,i){var r,u,s=(0,o.langNumeric)(n,(0,o.getLang)("reactions_n_reacted","raw")||"%s",!0);t.setAttribute("aria-label",s);var c=function(t){var e;return null!==(e=t.querySelector('[data-section-ref="like-button-count"]'))&&void 0!==e?e:void 0}(t);if(c){t.tt&&"object"==typeof t.tt&&(t.tt.shown||t.tt.showing||null===(u=null===(r=t.tt)||void 0===r?void 0:r.destroy)||void 0===u||u.call(r));var l=(0,o.langNumeric)(e,"%s",!0);(0,a.animateCount)(c,l,{allowZero:0!==i,str:!0,noWrapWidth:!0,noSpaceIfEmpty:!0})}}(b,_,g,w))},E=function(t,e){var n=(0,s.getLikeBtnElem)(t),i=e.counts;n&&i?function(t,e,n){var i=S(t);i&&i.objectRaw&&R(0,{counts:e,countsPrevious:n,objectRaw:i.objectRaw,reactionId:i.userReactionId,reactionSetId:i.reactionSetId,styleVariant:i.styleVariant})}(n,i,e.countsPrevious):console.warn("Unable to update object reactions",{objectRaw:t,options:e})},P=function(t,e){var n=e.counts,i=(0,s.getLikeBtnElem)(t);i&&function(t,e){t.setAttribute("data-reaction-counts",JSON.stringify(e))}(i,n)}},82982:(t,e,n)=>{"use strict";n.d(e,{reactionLogError:()=>a});var i=n(82701),r=n(85667),a=function(t){var e,n=t.error,a=(0,r.getReactionConfig)(),o=null!==(e=null==a?void 0:a.reportJsErrors)&&void 0!==e&&e;(0,i.reactionLogError)({error:n,reportError:o})}},72544:(t,e,n)=>{"use strict";n.d(e,{getLikeBtnElem:()=>i,getClosestLikeBtnContainerElem:()=>r,getLikeWrap:()=>a,getMenuMount:()=>o,getPreviewElem:()=>u});var i=function(t){var e;return null!==(e=document.querySelector('[data-section-ref="reactions-button"][data-reaction-target-object="'+t+'"]'))&&void 0!==e?e:void 0},r=function(t){var e;return null!==(e=t.closest('[data-section-ref="reactions-button-container"]'))&&void 0!==e?e:void 0},a=function(t){var e,n=i(t);if(n)return null!==(e=n.closest(".like_wrap"))&&void 0!==e?e:void 0},o=function(t){var e,n;return null!==(n=null===(e=t.closest('[data-section-ref="reactions-button-container"]'))||void 0===e?void 0:e.querySelector('[data-section-ref="reactions-menu-mount"]'))&&void 0!==n?n:null},u=function(t){return document.querySelector('[data-section-ref="reactions-preview-items"][data-reaction-target-object="'+t+'"]')}},85667:(t,e,n)=>{"use strict";n.d(e,{storageAddSets:()=>v,getReactionSet:()=>f,storageSetConfig:()=>m,getReactionConfig:()=>_});var i=n(70655),r=n(59397),a=n(17760),o=n(66e3),u=n(82982),s=n(95146),c=n(85207),l=(0,o.makeSharedState)("reactions-storage",(function(){return new Map}),{version:0}),d=(0,o.makeSharedState)("reactions-config",(function(){return{config:void 0}}),{version:0}),v=function(t){(0,c.isDebugEnabled)()&&console.log(t),Object.entries(t).forEach((function(t){var e=(0,i.__read)(t,2),n=e[0],o=e[1],c=(0,a.validateReactionSetPayloaditems)(o,n);if(c)(0,u.reactionLogError)({error:c.error});else{var d=o.map((function(t){return(0,i.__assign)((0,i.__assign)({},t),{title:(0,r.decodeHTMLEntities)(t.title)})}));l().set(n,(0,a.prepareReactionMenuSet)(n,d,{imageMenuSize:s.SIZE_96,imagePreviewSize:s.SIZE_32,imageStoryPanelSize:s.SIZE_128,imageStoryPreviewSize:s.SIZE_40}))}}))},f=function(t){var e=l().get(t);if(e)return e;var n=new Error("Reaction set not found: "+t);(0,u.reactionLogError)({error:n})},m=function(t){(0,c.isDebugEnabled)()&&console.log(t);var e=(0,a.parseReactionMenuConfig)(t);e?d().config=e:console.warn("Reactions: invalid menu config passed",t)},_=function(){var t;return null===(t=d())||void 0===t?void 0:t.config}},40672:(t,e,n)=>{"use strict";n.d(e,{isValidEnvironment:()=>o,preloadImage:()=>u,usePrevious:()=>s,usePreviousRef:()=>c,isValidButtonTitleVariant:()=>d,isValidButtonStyleVariant:()=>v});var i=n(67294),r=n(1925),a=n(54789),o=function(){var t,e,n;return"function"==typeof(null===(t=window.cur)||void 0===t?void 0:t.viewAsBox)?(window.cur.viewAsBox(),!1):!(window.vk.widget&&!window.vk.id)||(null===(n=null===(e=window.Widgets)||void 0===e?void 0:e.oauth)||void 0===n||n.call(e),!1)},u=function(t){return new Promise((function(e,n){var i=new Image;i.src=t,i.onload=function(){return e()},i.onerror=function(){return n()}}))},s=function(t){var e=(0,i.useRef)(t);return(0,i.useEffect)((function(){e.current=t})),e.current},c=function(t){var e=(0,i.useRef)(t);return(0,i.useEffect)((function(){e.current=t})),e},l=Object.values(a.ButtonStyleVariant),d=function(t){return r.ReactionMenuTitleVariants.includes(t)},v=function(t){return l.includes(t)}},65872:(t,e,n)=>{"use strict";n.d(e,{reactionsCountsUpdatePayload:()=>a,isReactionsFullUpdatePayload:()=>o,reactionsCountsOnlyUpdatePayload:()=>u});var i=n(70655),r=n(71904),a=function(t,e){return(0,i.__assign)((0,i.__assign)({kind:r.PayloadKindFull},t),{reactionIdState:{reactionId:e.id}})},o=function(t){return t.kind===r.PayloadKindFull},u=function(t){return(0,i.__assign)({kind:r.PayloadKindCountsOnly},t)}},71904:(t,e,n)=>{"use strict";n.d(e,{PayloadKindCountsOnly:()=>i,PayloadKindFull:()=>r});var i="counts_only",r="counts_with_current_reaction"},19970:(t,e,n)=>{"use strict";n.d(e,{postRenderReactionsInit:()=>x});var i=n(70655),r=n(40906),a=n(30104),o=n(70162),u=n(19633),s=n(64746),c=n(17760),l=n(15544),d=n(35676),v=n(86067),f=n(93682),m=n(46346),_=function(t){return!!t.getAttribute("data-reaction-button-text-is-counter")};var g=n(72544),p=n(85667),w="data-reaction-last-own-change-time",b="PostButtonReactions__icon--animationActive";var I=function(t){var e,n=null===(e=t.__reactionIconAnimation)||void 0===e?void 0:e.animationItem;n&&(!n._cbs||n.destroy(),delete t.__reactionIconAnimation)},S=function(t,e,n,r){return(0,i.__awaiter)(void 0,void 0,Promise,(function(){var a,o,s;return(0,i.__generator)(this,(function(i){switch(i.label){case 0:return!(t!==(null===(s=n.__reactionIconAnimation)||void 0===s?void 0:s.animationURL))&&t||(I(n),e.innerHTML="",n.classList.remove(b)),r&&t?[4,(0,m.getAnimationAsync)(t,e,{loadAnimationParams:{autoplay:!0,loop:!1}})]:[2];case 1:return a=i.sent(),(0,u.onAnimationReady)(a,(function(){n.classList.add(b)})),o=function(){var t;!0===(null==(t=(0,p.getReactionConfig)())?void 0:t.animationShowStaticAfterEnd)&&(n.classList.remove(b),I(n))},a.addEventListener("complete",o),n.__reactionIconAnimation={animationItem:a,animationURL:t},[2]}}))}))},y=function(t,e){var n=t.querySelector('[data-section-ref="reactions-button-icon"]');if(n){var i=e.currentOption,r=e.isUserAction;if(i.isReactionSet){var a=i.current,o=null==a?void 0:a.imageMenuURL;n.style.backgroundImage="url('"+o+"')",n.setAttribute("aria-label",null==a?void 0:a.title)}else{var u=i.default;n.style.backgroundImage="",(null==u?void 0:u.title)&&n.setAttribute("aria-label",null==u?void 0:u.title)}n.classList.toggle("PostButtonReactions__icon--custom",i.isReactionSet);var s=i.isReactionSet?i.current.animationURL:void 0,c=function(t){var e=t.querySelector(".PostButtonReactions__iconAnimation");return e||(e=(0,l.se)('<div class="PostButtonReactions__iconAnimation" data-section-ref="reactions-button-icon-animation"></div>'),t.appendChild(e),e)}(n);S(s,c,n,r)}},R=function(t,e,n){t.classList.toggle("PostButtonReactions--icon-active",e),t.classList.toggle("PostButtonReactions--active",e)},E=function(t,e,n,r){var a=!(0,c.isReactionIdUnset)(e),u=function(t,e){var n=(0,c.getDefaultReaction)(t),i=void 0;if((0,c.isReactionIdUnset)(e)){if(n)return{isReactionSet:!1,default:n}}else{if(i=t.itemsById[e])return{isReactionSet:!0,current:i};console.error(new Error("Missing reaction meta for "+e+" in set '"+t.id+"'"))}return{_error:!0}}(n,e);"_error"in u||(y(t,{currentOption:u,isUserAction:r}),function(t,e){var n=e.currentOption,r=n.isReactionSet?n.current.titleColor:void 0,a=n.isReactionSet?n.current.backgroundColor:void 0,o=r?{"--reaction-button-title-color-light":r.light,"--reaction-button-title-color-dark":r.dark}:{"--reaction-button-title-color-light":null,"--reaction-button-title-color-dark":null},u=a?{"--reaction-button-background-color-light":a.light,"--reaction-button-background-color-dark":a.dark}:{"--reaction-button-background-color-light":null,"--reaction-button-background-color-dark":null},s=(0,i.__assign)((0,i.__assign)({},o),u);Object.entries(s).forEach((function(e){var n=(0,i.__read)(e,2),r=n[0],a=n[1];t.style.setProperty(r,a)}))}(t,{currentOption:u}),function(t,e){var n=e.currentOption,i="";i=n.isReactionSet?(0,o.langReplace)((0,v.getLang)("reactions_button_unset_reaction_title")||"",{reaction_name:n.current.title||""}):(0,o.langReplace)((0,v.getLang)("reactions_button_set_reaction_with_name")||"",{reaction_name:n.default.title||""})||(0,v.getLang)("reactions_button_title")||"",t.setAttribute("aria-label",i||"")}(t,{currentOption:u}),_(t)||function(t,e){var n=t.querySelector('[data-section-ref="reactions-button-title"]');if(n){var i=e.currentOption,r=i.isReactionSet?i.current.title:i.default.title;r?n.innerText=r:(0,s.isDebugEnabled)()&&console.log("reactions: setReactionNameTitle: missing title",i)}}(t,{currentOption:u})),R(t,a),r&&function(t,e){t.setAttribute(w,String(e))}(t,Date.now())},P=function(t,e,n,i,r){var a=function(t,e,n,i){if(!_(t))return{kind:"disabled"};if(!n)return{kind:"error"};var r=0!==(i?(0,c.calcCountersSum)(i):0);if(!(0,c.hasReactionsForCounts)(n))return{kind:"enabled",allowZeroAnimation:r,buttonText:""};var a=(0,c.calcCounters)(n,e),o=(0,c.calcCountersWeightedSum)(a);return{kind:"enabled",allowZeroAnimation:r,buttonText:(0,v.langNumeric)(o,"%s",!0)}}(t,e,i,r);(function(t){return!!t&&"disabled"!==t.kind})(a)&&(function(t,e){var n=t.querySelector('[data-section-ref="reactions-button-title"]');if(n){var i=e.counterForTitle;if(function(t){return"enabled"===t.kind}(i)){var r=i.buttonText;(0,d.animateCount)(n,r,{allowZero:i.allowZeroAnimation,str:!0,noWrapWidth:!0,noSpaceIfEmpty:!0})}else(0,s.isDebugEnabled)()&&console.log("reactions: setReactionTitle: missing title",i)}}(t,{counterForTitle:a}),i&&function(t,e){var n,i=null===(n=(0,g.getClosestLikeBtnContainerElem)(t))||void 0===n?void 0:n.querySelector('[data-section-ref="reactions-button-screen-reader-counter"]');if(i){var r=(0,v.langNumeric)(e,(0,v.getLang)("reactions_n_reacted","raw")||"%s",!0);i.innerText=r}}(t,(0,c.calcCountersSum)(i)))};var A=n(59397);function L(t,e){var n=(void 0===e?{}:e).scrollByImpl,i=void 0===n?window.scrollBy:n,r=t;return{start:(0,A.once)((function(t){t&&(r=t);var e=(0,a.getElementOffset)(r);return(0,A.once)((function(t){if(t&&(r=t),r.isConnected){var n=(0,a.getElementOffset)(r);i(0,n.top-e.top)}}))}))}}var k=n(65864),h=n(85207),T=n(98306),C=n(8706),O=n(65872),B=n(53580),D=n(96535),U=n(28634),V=n(92239),N=n(4608),j=function(t,e,n){var i;void 0===n&&(n=null===(i=window.cur)||void 0===i?void 0:i.wallTpl);var r=null==n?void 0:n[t];if(r)return function(t){return t.replace(/%[-\w]+%/g,"")}((0,l.rs)(r,e));console.warn("renderTemplate: missing template '"+t+"'",n)},M=function(t){for(var e=t.isUserAction,n=void 0!==e&&e,r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];n?console.error.apply(console,(0,i.__spreadArray)([],(0,i.__read)(r),!1)):(0,h.isDebugEnabled)()&&console.warn.apply(console,(0,i.__spreadArray)([],(0,i.__read)(r),!1))};var F=function(t,e,n){var i=n.isActionStatusBarVisible,r=n.isReactionsPreviewVisible,a=n.positionTrackingEnd,o=function(t,e){var n,i,r=(0,g.getLikeWrap)(t);if(r){var a=(0,D.getPostElem)(e,r),o=null==a?void 0:a.querySelector('[data-section-ref="post-action-status-bar"]');if(o)return{actionStatusBar:o};var u=(0,U.isWkLayerWallPostOpen)()?null===(n=window.wkcur)||void 0===n?void 0:n.wallTpl:null===(i=window.cur)||void 0===i?void 0:i.wallTpl,s=(0,l.se)(j("post_action_status_bar",{class:"PostActionStatusBar--hidden"},u));if(s)return(0,l.domInsertBefore)(s,r),{actionStatusBar:s}}}(t,e.postFullId);if(o){var u=o.actionStatusBar;if(u.classList.toggle("PostActionStatusBar--hidden",!i),i&&!(0,g.getPreviewElem)(t)){var s=function(t,e,n){var i,r;void 0===n&&(n={});var a=(0,U.isWkLayerWallPostOpen)()?null===(i=window.wkcur)||void 0===i?void 0:i.wallTpl:null===(r=window.cur)||void 0===r?void 0:r.wallTpl,o=(0,A.classNames)({"ReactionsPreview--empty":!t,"ReactionsPreview--isInActionStatusBar":!!n.isInActionStatusBar});return j("post_reactions_preview",{class:o,object_raw:e},a)}(r,t,{isInActionStatusBar:!0});u.prepend((0,l.se)(s))}if(a){var c=(0,g.getLikeBtnElem)(t);null==a||a(c)}}else M({},"Unable to init ActionStatusBar in post",e)},W=function(t){var e=function(t){var e=t.getAttribute(w);if(e&&(0,r.isNumeric)(e))try{return new Date(Number.parseInt(e)).getTime()||void 0}catch(t){return void console.error(t)}}(t);if(!e)return!1;var n=e+1e4;return Date.now()<n},q=function(t){if(function(t){return void 0!==t.counts}(t)){var e=(0,k.likePostObjectId)(t.postFullId),n=(0,D.getPostElem)(t.postFullId,(0,g.getLikeWrap)(e));n||M(t,"Missing post element for reactions preview update",{payload:t,likeWrap:(0,g.getLikeWrap)(e)});var i=(0,g.getLikeBtnElem)(e);if(i){var r=(0,T.reactionsElemPayload)(i),a=null==r?void 0:r.counts;H({elemPayload:r,likeBtnElem:i,likeObjectId:e,payload:t}),Z({countsPrevious:a,likeBtnElem:i,likeObjectId:e,payload:t,postEl:n})}else M(t,"Unable to find reactions button",{likeObjectId:e})}else M(t,"Counts is invalid or missing")},H=function(t){var e=t.elemPayload,n=t.likeBtnElem,i=t.likeObjectId,r=t.payload,a=r.counts;if(!!r.isQueueUpdate&&W(n))(0,h.isDebugEnabled)()&&console.log("Ignoring reactions update from queue",r);else{if(e){var o=e.counts,u=e.reactionSetId,s=(0,p.getReactionSet)(u);if((0,O.isReactionsFullUpdatePayload)(r)){var l=r.reactionIdState.reactionId;s&&E(n,l,s,r.isUserAction)}s&&(P(n,s,r.isUserAction,a,o),function(t,e){var n=!e||!(0,c.hasReactionsForCounts)(e);t.classList.toggle("PostBottomAction--empty",n)}(n,a))}if((0,O.isReactionsFullUpdatePayload)(r))!function(t,e){t.setAttribute(f.ATTR_USER_REACTION_ID,(0,c.isReactionIdUnset)(e)?"":String(e))}(n,l=r.reactionIdState.reactionId),r.isUserAction&&(null==e?void 0:e.objectRaw)&&(0,V.emitDataUpdate)(e.objectRaw,{currentReactionId:l});(0,T.updateReactionsButtonForCounts)(i,{counts:a})}},Z=function(t){var e=t.countsPrevious,n=t.likeBtnElem,i=t.likeObjectId,r=t.payload,a=t.postEl,o=r.counts,u=r.previewVisibility,s=function(t,e){if((0,C.isIntentPreviewInActionStatusBar)(t))return{previewVariant:N.PreviewVariantActionStatusBar};if((0,C.isIntentPreviewHidden)(t))return{previewVariant:N.PreviewVariantHidden};if((0,C.isIntentPreviewUseCurrent)(t)){var n=(0,T.getPreviewVariantForLikeBtn)(e);if(n)return{previewVariant:n}}}(void 0===u?C.previewVisibilityUseCurrent:u,n);if(s){var c=s.previewVariant,l=(0,C.isVariantInActionStatusBar)(c),d=(0,T.shouldReactionsPreviewBeVisible)(o),v=(0,C.isVariantHidden)(c)||l&&!d;if(l){var f=void 0;r.isPrimaryLikeButtonClick&&!r.isFromWkLayer&&(f=L(n).start());var m=d;null==a||a.classList.toggle("post--withActionStatusBar",m),F(i,r,{isActionStatusBarVisible:m,isReactionsPreviewVisible:d,positionTrackingEnd:f})}v||(0,T.updateReactionsPreview)(i,{counts:o,countsPrevious:e})}},z=function(t){if(!h.ENABLED_IN_POST_REPLY)return!1;var e=t.counts;if(e){var n=(0,k.likeReplyObjectId)(t.replyFullId);(0,T.updateReactionsPreview)(n,{counts:e,countsPrevious:void 0}),(0,T.updateReactionsButtonForCounts)(n,{counts:e})}},x=function(){var t=[(0,B.registerUniqueListener)("wall-post-action-status-bar",B.WallDataEvents.post_reactions_counts_update,q),(0,B.registerUniqueListener)("wall-reply-reactions-counts",B.WallDataEvents.reply_reactions_counts_update,z)];return{onDestroy:function(){t.forEach((function(t){t()})),t=[]}}}},53580:(t,e,n)=>{"use strict";n.d(e,{WallDataEvents:()=>o,registerUniqueListener:()=>c,registerNonGlobalNonUniqueListener:()=>l,emitEvent:()=>d});var i=n(70655),r=n(61508),a=n(66e3),o={post_reactions_counts_update:"wall/post_reactions_counts_update",reply_reactions_counts_update:"wall/reply_reactions_counts_update",post_subscribe_update:"wall/post_subscribe_update"},u=(0,a.makeSharedState)("wall-data",(function(){return{emitter:new r.default,keyedListeners:Object.create(null)}}),{version:0}),s=function(t,e,n){var r,a,o=u(),s=null===(a=null===(r=o.keyedListeners)||void 0===r?void 0:r[t])||void 0===a?void 0:a[e];return s&&o.emitter.removeListener(t,s),function(t,e,n){var r,a=u();return a.emitter.addListener(t,n),a.keyedListeners[t]=(0,i.__assign)((0,i.__assign)({},a.keyedListeners[t]),((r={})[e]=n,r)),function(){var i,r;a.emitter.removeListener(t,n),(null===(i=a.keyedListeners[t])||void 0===i?void 0:i[e])===n&&(null===(r=a.keyedListeners[t])||void 0===r||delete r[e])}}(t,e,n)},c=function(t,e,n){return s(e,t,n)},l=function(t,e){return function(t,e){var n=u();return n.emitter.addListener(t,e),function(){n.emitter.removeListener(t,e)}}(t,e)},d=function(t,e){u().emitter.emit(t,e)}},96535:(t,e,n)=>{"use strict";n.d(e,{getPostElem:()=>i,replyUserImageLinkClosest:()=>r,replyUserImageImg:()=>a});var i=function(t,e){var n,i;return null!==(i=null!==(n=function(t){var e;if("string"==typeof t)return null!==(e=document.querySelector("#post"+t))&&void 0!==e?e:void 0}(t))&&void 0!==n?n:null==e?void 0:e.closest("._post, .wl_post"))&&void 0!==i?i:void 0},r=function(t){var e;return null!==(e=t.closest(".reply_image, ._reply_image"))&&void 0!==e?e:void 0},a=function(t){var e;return null!==(e=t.querySelector("img.reply_img"))&&void 0!==e?e:void 0}},28634:(t,e,n)=>{"use strict";n.d(e,{isWkLayerWallPostOpen:()=>i});var i=function(){return!!window.cur.wallLayer}}}]);try{stManager.done("dist/90f8cf219bb6d5a2f2ecd964325e4940.022ea1221951cb7e5288.js")}catch(t){}