(self.webpackChunkvk=self.webpackChunkvk||[]).push([[77433],{54632:(e,t,r)=>{"use strict";r.d(t,{useInView:()=>l});var n=r(67294);const i=new Map,o=new WeakMap;let a,s=0;function c(e){return Object.keys(e).sort().filter((t=>void 0!==e[t])).map((t=>{return`${t}_${"root"===t?(r=e.root,r?(o.has(r)||(s+=1,o.set(r,s.toString())),o.get(r)):"0"):e[t]}`;var r})).toString()}function d(e,t,r={},n=a){if(void 0===window.IntersectionObserver&&void 0!==n){const i=e.getBoundingClientRect();return t(n,{isIntersecting:n,target:e,intersectionRatio:"number"==typeof r.threshold?r.threshold:0,time:0,boundingClientRect:i,intersectionRect:i,rootBounds:i}),()=>{}}const{id:o,observer:s,elements:d}=function(e){let t=c(e),r=i.get(t);if(!r){const n=new Map;let o;const a=new IntersectionObserver((t=>{t.forEach((t=>{var r;const i=t.isIntersecting&&o.some((e=>t.intersectionRatio>=e));e.trackVisibility&&void 0===t.isVisible&&(t.isVisible=i),null==(r=n.get(t.target))||r.forEach((e=>{e(i,t)}))}))}),e);o=a.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),r={id:t,observer:a,elements:n},i.set(t,r)}return r}(r);let u=d.get(e)||[];return d.has(e)||d.set(e,u),u.push(t),s.observe(e),function(){u.splice(u.indexOf(t),1),0===u.length&&(d.delete(e),s.unobserve(e)),0===d.size&&(s.disconnect(),i.delete(o))}}class u extends n.Component{constructor(e){super(e),this.node=null,this._unobserveCb=null,this.handleNode=e=>{this.node&&(this.unobserve(),e||this.props.triggerOnce||this.props.skip||this.setState({inView:!!this.props.initialInView,entry:void 0})),this.node=e||null,this.observeNode()},this.handleChange=(e,t)=>{e&&this.props.triggerOnce&&this.unobserve(),isPlainChildren(this.props)||this.setState({inView:e,entry:t}),this.props.onChange&&this.props.onChange(e,t)},this.state={inView:!!e.initialInView,entry:void 0}}componentDidUpdate(e){e.rootMargin===this.props.rootMargin&&e.root===this.props.root&&e.threshold===this.props.threshold&&e.skip===this.props.skip&&e.trackVisibility===this.props.trackVisibility&&e.delay===this.props.delay||(this.unobserve(),this.observeNode())}componentWillUnmount(){this.unobserve(),this.node=null}observeNode(){if(!this.node||this.props.skip)return;const{threshold:e,root:t,rootMargin:r,trackVisibility:n,delay:i,fallbackInView:o}=this.props;this._unobserveCb=d(this.node,this.handleChange,{threshold:e,root:t,rootMargin:r,trackVisibility:n,delay:i},o)}unobserve(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)}render(){if(!isPlainChildren(this.props)){const{inView:e,entry:t}=this.state;return this.props.children({inView:e,entry:t,ref:this.handleNode})}const e=this.props,{children:t,as:r}=e,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(0;n<o.length;n++)o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,_excluded);return n.createElement(r||"div",_extends({ref:this.handleNode},i),t)}}function l({threshold:e,delay:t,trackVisibility:r,rootMargin:i,root:o,triggerOnce:a,skip:s,initialInView:c,fallbackInView:u,onChange:l}={}){const f=n.useRef(),p=n.useRef(),[v,h]=n.useState({inView:!!c});p.current=l;const m=n.useCallback((n=>{void 0!==f.current&&(f.current(),f.current=void 0),s||n&&(f.current=d(n,((e,t)=>{h({inView:e,entry:t}),p.current&&p.current(e,t),t.isIntersecting&&a&&f.current&&(f.current(),f.current=void 0)}),{root:o,rootMargin:i,threshold:e,trackVisibility:r,delay:t},u))}),[Array.isArray(e)?e.toString():e,o,i,a,s,r,u,t]);n.useEffect((()=>{f.current||!v.entry||a||s||h({inView:!!c})}));const _=[m,v.inView,v.entry];return _.ref=_[0],_.inView=_[1],_.entry=_[2],_}},84970:(e,t,r)=>{"use strict";r.d(t,{usePrevious:()=>h,useDidUpdate:()=>m,useDebounced:()=>_,useOnline:()=>g,OnlinesProvider:()=>b,useDispatch:()=>k,DispatchProvider:()=>I,useHelpHints:()=>C,HelpHintsProvider:()=>P,useTypings:()=>O,TypingsProvider:()=>x,usePixelDensity:()=>j,matchAddEventListener:()=>M,useNow:()=>D,usePeers:()=>T,PeersProvider:()=>F,useConvos:()=>N,ConvosProvider:()=>L,useFeatureFlags:()=>V,FeatureFlagsProvider:()=>q,useOwner:()=>K,OwnerProvider:()=>H,useViewer:()=>W,ViewerProvider:()=>Y,useAppSource:()=>$,useVideomessageShapes:()=>J,VideomessageShapesProvider:()=>Z,AppSourceProvider:()=>ee,useBrowserEnv:()=>te,BrowserEnvProvider:()=>ne,useViewport:()=>ie,useRead:()=>ae,useCombinedRefs:()=>se,InsertIntoCacheProvider:()=>de,useInsertIntoCache:()=>ue,ConvosSearchIndexProvider:()=>fe,useConvosSearchIndex:()=>pe});var n=r(22559),i=r(56568),o=r(67294),a=r(54632),s=r(14432),c=r(33600),d=r(21705),u=r(37021);function l(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function h(e){var t=(0,o.useRef)();return(0,o.useEffect)((function(){t.current=e}),[e]),t.current}function m(e,t){var r=(0,o.useRef)(!1);(0,o.useEffect)((function(){if(r.current)return e()}),t),(0,o.useEffect)((function(){r.current=!0}),[])}function _(e,t){var r=(0,o.useState)({debounced:e,debouncedUpdatesCount:0}),n=(0,i.default)(r,2),a=n[0],s=n[1];return(0,o.useLayoutEffect)((function(){if(0!==t){var r=setTimeout((function(){s((function(t){var r=t.debouncedUpdatesCount;return{debounced:e,debouncedUpdatesCount:r+1}}))}),t);return function(){clearTimeout(r)}}s((function(t){return v(v({},t),{},{debounced:e})}))}),[e,t]),a}function g(e){var t=(0,o.useContext)(y);return!!s.isUserPeerId(e)&&t.has(e)}var y=o.createContext(new Set),b=y.Provider;function k(){var e=(0,o.useContext)(w);if(!e)throw new Error("DispatchProvider не добавлен в дерево Реакта!");return e}var w=o.createContext(null),I=w.Provider;function C(){var e=(0,o.useContext)(A);if(void 0===e)throw new Error("HelpHintsProvider не добавлен в дерево Реакта!");return e}var A=o.createContext(null),P=A.Provider;function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"full",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,n=(0,o.useContext)(S),i=T(),a=te(),c=a.lang,d=n.get(e);if(d){var f,p=[],v=new Set,h=l(u.TypingVariants);try{for(h.s();!(f=h.n()).done;){var m=f.value,_=d[m];_&&(p.push(m),_.peerIds.forEach((function(e){return v.add(e)})))}}catch(e){h.e(e)}finally{h.f()}var g=p.length>1?"text":p[0]||"text";if(0===r)return{text:c.use("me_typing_".concat(g)),type:g};var y,b,k=[],w=l(v);try{for(w.s();!(y=w.n()).done;){var I=y.value,C=i.get(I);if(C&&(k.push(C),k.length===r))break}}catch(e){w.e(e)}finally{w.f()}var A=", ",P=v.size-k.length;switch(!0){case 0===k.length&&P>0:b=c.use("me_typing_people",{num:P});break;case P>0:b=k.map((function(e){return s.shortName(e)})).join(A),b=c.use("me_typing_names_lots",{num:P,values:{names:b}});break;case k.length>1:var O=k.length>r-1?k.slice(0,r-1).map((function(e){return s.shortName(e)})).join(A):k[0]?s.shortName(k[0]):"",x=k[k.length-1],E=x?s.shortName(x):"";b=c.use("me_typing_names_couple",{values:{before:O,after:E}});break;case 1===k.length:b=k[0]?s.shortName(k[0]):"";break;default:b=""}var j="compact"===t?b:c.use("me_typing_".concat(g,"_named"),{num:k.length,values:{names:b}});return{text:j,type:g}}}var S=o.createContext(new Map),x=S.Provider,E=function(){return window.devicePixelRatio>1.3};function j(){var e=(0,o.useState)(E),t=(0,i.default)(e,2),r=t[0],n=t[1];return(0,o.useEffect)((function(){return M(window.matchMedia("(resolution: ".concat(window.devicePixelRatio,"dppx)")),(function(){n(E)}))}),[]),r}function M(e,t){try{return e.addEventListener("change",t),function(){e.removeEventListener("change",t)}}catch(r){return e.addListener(t),function(){e.removeListener(t)}}}function D(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6e4,t=(0,o.useState)(Date.now),r=(0,i.default)(t,2),n=r[0],a=r[1];return(0,o.useLayoutEffect)((function(){var t=setInterval((function(){a(Date.now())}),e);return function(){return clearInterval(t)}}),[e]),n}function T(){return(0,o.useContext)(U)}var U=o.createContext(new Map),F=U.Provider;function N(){return(0,o.useContext)(R)}var R=o.createContext(new Map),L=R.Provider;function V(){var e=(0,o.useContext)(B);if(!e)throw new Error("FeatureFlagsProvider не добавлен в дерево Реакта!");return e}var B=o.createContext(null),q=B.Provider;function K(){var e=(0,o.useContext)(G);if(!e)throw new Error("OwnerProvider не добавлен в дерево Реакта!");return e}var G=o.createContext(null),H=G.Provider;function W(){var e=(0,o.useContext)(z);if(!e)throw new Error("ViewerProvider не добавлен в дерево Реакта!");return e}var z=o.createContext(null),Y=z.Provider;function $(){var e=(0,o.useContext)(Q);if(!e)throw new Error("AppSourceProvider не добавлен");return e}function J(){return(0,o.useContext)(X)}var X=o.createContext(new Map),Z=X.Provider,Q=o.createContext(null),ee=Q.Provider;function te(){var e=(0,o.useContext)(re);if(!e)throw new Error("BrowserEnvProvider не добавлен в дерево Реакта!");return e}var re=o.createContext(null),ne=re.Provider;function ie(e){var t=e.debounced,r=void 0!==t&&t,n=(0,o.useState)(oe),a=(0,i.default)(n,2),s=a[0],c=a[1],u=(0,o.useRef)((0,d.debounce)(c,300,!1));return(0,o.useLayoutEffect)((function(){var e=u.current,t=function(){r?e(oe()):c(oe())};return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t),r&&e.cancel()}}),[r]),s}function oe(){return"undefined"==typeof window?[0,0]:[document.documentElement.clientWidth,document.documentElement.clientHeight]}function ae(e){var t=e.isUnread,r=e.isOut,n=e.onRead,i=te().idle,s=(0,a.useInView)({threshold:.01,triggerOnce:!0,delay:500}),c=s.ref,d=s.inView;return(0,o.useEffect)((function(){if(d&&t&&!r)return i.isIdle()?i.subscribe((function(e){e||setTimeout((function(){return n()}),1e3)})):void n()}),[d,t,n,i,r]),c}function se(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=(0,o.useRef)(null);return o.useEffect((function(){t.forEach((function(e){e&&("function"==typeof e?e(n.current):e.current=n.current)}))}),[t]),n}var ce=o.createContext(null),de=ce.Provider;function ue(){var e=(0,o.useContext)(ce);if(!e)throw new Error("InsertIntoCacheProvider не добавлен в дерево Реакта!");return e}var le=o.createContext(c.create()),fe=le.Provider;function pe(){return(0,o.useContext)(le)}},36698:(e,t,r)=>{"use strict";r.d(t,{UIConfigProvider:()=>m,useDeviceData:()=>g,useLayoutData:()=>_});var n=r(56568),i=r(67294),o=r(44801),a=r(84970),s=r(62276),c=r(21705),d=r(25155),u=r(50706),l=r(22559),f=function(){function e(){(0,d.default)(this,e),(0,l.default)(this,"startX",0),(0,l.default)(this,"startY",0)}return(0,u.default)(e,[{key:"onTouchMove",value:function(e){var t=p(e);if(e.target&&t&&!function(e){var t=window.innerWidth/window.document.documentElement.clientWidth;if(1===e.length)return!1;return 1!==t}(t)&&!function(e,t,r){var n=10,i=r[0],o=i.screenY,a=i.screenX,s=o<=t+n&&o>=t-n;return e!==a&&s}(this.startX,this.startY,t)){for(var r=e.target;r!==document.body;){if(v(r))return;var n=h(r);if(n)return void(n(this.startY,t[0].screenY)&&e.preventDefault());var i=r.parentElement;if(!i)break;r=i}e.preventDefault()}}},{key:"onTouchStart",value:function(e){var t=p(e);t&&(this.startX=t[0].screenX,this.startY=t[0].screenY)}},{key:"enable",value:function(){window.addEventListener("touchstart",this.onTouchStart,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1})}},{key:"disable",value:function(){window.removeEventListener("touchstart",this.onTouchStart,!1),window.removeEventListener("touchmove",this.onTouchMove,!1)}}],[{key:"supported",value:function(){var e=document.createElement("div");document.documentElement.appendChild(e),e.style.WebkitOverflowScrolling="touch";var t="getComputedStyle"in window&&"touch"===window.getComputedStyle(e).getPropertyValue("-webkit-overflow-scrolling");return document.documentElement.removeChild(e),t}}]),e}();function p(e){return(0,c.toNonEmpty)(Array.from(e.touches))}function v(e){return"INPUT"===e.nodeName&&"range"===e.getAttribute("type")}function h(e){var t=window.getComputedStyle(e),r=t.getPropertyValue("-webkit-overflow-scrolling"),n=t.getPropertyValue("overflow-y"),i=parseInt(t.getPropertyValue("height"),10),o="touch"===r&&("auto"===n||"scroll"===n),a=e.scrollHeight>e.offsetHeight;return!(!o||!a)&&function(t,r){var n=t>=r,o=t<=r&&0===e.scrollTop,a=n&&e.scrollHeight-e.scrollTop===i;return o||a}}var m=function(e){var t=e.scheme,r=void 0===t?"VKCOM":t,s=e.theme,d=void 0===s?"system":s,u=e.children,l=e.locale,p=e.onThemeUpdated,v=(0,i.useState)("system"!==d?d:"light"),h=(0,n.default)(v,2),m=h[0],_=h[1],g=(0,i.useRef)(null),y=(0,i.useCallback)((function(e){_(e.matches?"dark":"light")}),[]);(0,i.useEffect)((function(){var e,t=window.matchMedia("(prefers-color-scheme: dark)");switch(d){case"light":case"dark":_(d),null===(e=g.current)||void 0===e||e.call(g);break;case"system":g.current=(0,a.matchAddEventListener)(t,y),_(t.matches?"dark":"light");break;default:(0,c.exhaustivenessCheck)(d)}}),[y,d]),(0,i.useEffect)((function(){return function(){var e;return null===(e=g.current)||void 0===e?void 0:e.call(g)}}),[]),(0,i.useLayoutEffect)((function(){null==p||p(m)}),[p,m]),(0,i.useEffect)((function(){var e=f.supported()?new f:void 0;return null==e||e.enable(),function(){null==e||e.disable()}}),[]);var k="VKCOM"===r?"light"===m?"vkcom_light":"vkcom_dark":"light"===m?o.Scheme.BRIGHT_LIGHT:o.Scheme.SPACE_GRAY,w=(0,a.useViewport)({debounced:!0}),I=(0,n.default)(w,1)[0]<640?"one-column":"two-column";return i.createElement(o.ConfigProvider,{locale:l,platform:o.Platform.IOS,scheme:k},i.createElement(o.ConfigProvider,{locale:l,platform:o.Platform.VKCOM,scheme:"inherit"},i.createElement(o.AdaptivityProvider,null,i.createElement(b,{value:{mode:I}},u))))};function _(){var e=(0,i.useContext)(y);if(!e)throw new Error("LayoutDataContext не добавлен в дерево Реакта!");return e}function g(){var e=(0,i.useContext)(s.AdaptivityContext);if(!e)throw new Error("AdaptivityContext не добавлен в дерево Реакта!");return{isTouchOnly:!e.deviceHasHover}}var y=i.createContext(null),b=y.Provider},51225:(e,t,r)=>{"use strict";r.d(t,{resolveMiniAppId:()=>l,preview:()=>f,link:()=>p,ids:()=>v,last:()=>h,addAttach:()=>m,removeAttach:()=>_,isChatInviteLink:()=>g,isCallJoinLink:()=>y,rearrangeAttaches:()=>b,generatePollBackgroundGradientStyle:()=>k,getPollReflowKey:()=>w});var n=r(80312),i=r(56568),o=r(21705),a=r(14432),s=r(90831),c=r(16352);function d(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var l=function(e){return e};function f(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=["o","p","q","r"];if("Video"===e.kind||"Gift"===e.kind||"PollBackgroundPhoto"===e.kind||"VideoMessage"===e.kind)return e.image.find((function(e){var t=e.width,i=e.height;return t>=r&&i>=n}))||e.image.reduce((function(e,t){return!e||t.width*t.height>e.width*e.height?t:e}))||null;var s,c="Photo"===e.kind?e.sizes:e.image;return c?o?(null===(s=Array.from(c.entries()).find((function(e){var t=(0,i.default)(e,2),o=t[0],s=t[1],c=s.width,d=s.height;return a.includes(o)&&c>=r&&d>=n})))||void 0===s?void 0:s[1])||c.get("r")||c.get("q")||c.get("p")||c.get("o")||null:(null===(t=Array.from(c.entries()).find((function(e){var t=(0,i.default)(e,2),o=t[0],s=t[1],c=s.width,d=s.height;return!a.includes(o)&&c>=r&&d>=n})))||void 0===t?void 0:t[1])||c.get("w")||c.get("z")||c.get("y")||c.get("x")||c.get("m")||c.get("s")||null:null}function p(e,t){switch(e.kind){case"Photo":var r=e.accessKey?"/".concat(e.accessKey):"";return"/im?z=photo".concat(e.ownerId,"_").concat(e.id).concat(r);case"Video":var n=e.accessKey?"/".concat(e.accessKey):"";return"/im?z=video".concat(e.ownerId,"_").concat(e.id).concat(n);case"Audio":return"/audio".concat(e.ownerId,"_").concat(e.id);case"AudioPlaylist":var i=e.accessKey?"_".concat(e.accessKey):"";return"/music/".concat(e.type,"/").concat(e.ownerId,"_").concat(e.id).concat(i);case"Podcast":return"/im?z=podcast".concat(e.ownerId,"_").concat(e.id);case"Doc":return"/doc".concat(e.ownerId,"_").concat(e.id);case"Sticker":return"/stickers";case"Link":case"Article":case"InviteLink":return e.url;case"Voice":case"MoneyTransfer":case"MoneyRequest":case"Graffiti":case"MarketAlbum":case"FinishedCall":case"Geo":case"ActiveCall":case"VideoMessage":case"Widget":return"";case"Market":return"/market".concat(e.ownerId,"?w=product").concat(e.ownerId,"_").concat(e.id);case"Gift":return"/gifts";case"Poll":return"/im?w=poll".concat(e.ownerId,"_").concat(e.id);case"Story":return"/im?w=story".concat(e.ownerId,"_").concat(e.id,"/").concat(e.ownerId,"_").concat(e.id);case"Wall":return null!=t&&t.me_channels?"/#".concat(c.CHANNELS_BASE_PATH,"/").concat(e.ownerId,"?cmid=").concat(e.id):"/wall".concat(e.ownerId,"_").concat(e.id);case"WallReply":return"/wall".concat(e.ownerId,"_").concat(e.postId,"?reply=").concat(e.id)+(e.parentsStack&&e.parentsStack.length>0?"&thread=".concat(e.parentsStack.join("_")):"");case"WallHistory":return"/wall".concat(e.ownerId,"_").concat(e.id);case"MiniApp":return"/im?w=".concat(e.appLink);case"DonutLink":return"/donut/club".concat(a.toRealId(e.ownerId));default:return(0,o.exhaustivenessCheck)(e)}}function v(e){var t,r=[],n=d(e.photos||[]);try{for(n.s();!(t=n.n()).done;){var i=t.value;r.push("photo".concat(i.ownerId,"_").concat(i.id))}}catch(e){n.e(e)}finally{n.f()}var o,a=d(e.videos||[]);try{for(a.s();!(o=a.n()).done;){var s=o.value;r.push("video".concat(s.ownerId,"_").concat(s.id))}}catch(e){a.e(e)}finally{a.f()}var c,u=d(e.audios||[]);try{for(u.s();!(c=u.n()).done;){var l=c.value;r.push("audio".concat(l.ownerId,"_").concat(l.id))}}catch(e){u.e(e)}finally{u.f()}e.audioPlaylist&&r.push("audio_playlist".concat(e.audioPlaylist.ownerId,"_").concat(e.audioPlaylist.id)),e.podcast&&r.push("podcast".concat(e.podcast.ownerId,"_").concat(e.podcast.id)),e.market&&r.push("market".concat(e.market.ownerId,"_").concat(e.market.id));var f,p=d(e.docs||[]);try{for(p.s();!(f=p.n()).done;){var v=f.value;r.push("doc".concat(v.ownerId,"_").concat(v.id))}}catch(e){p.e(e)}finally{p.f()}return e.voice&&r.push("doc".concat(e.voice.ownerId,"_").concat(e.voice.id)),e.wall&&r.push("wall".concat(e.wall.ownerId,"_").concat(e.wall.id)),e.wallReply&&r.push("wall_reply".concat(e.wallReply.ownerId,"_").concat(e.wallReply.id)),e.poll&&r.push("poll".concat(e.poll.ownerId,"_").concat(e.poll.id)),e.story&&r.push("story".concat(e.story.ownerId,"_").concat(e.story.id)),e.donutLink&&r.push("donut_link".concat(e.donutLink.ownerId)),e.widget&&r.push("widget".concat(e.widget.id)),r}function h(e){return 0===Object.keys(e).length?null:e.widget||e.wallReply||e.wall||e.poll||e.donutLink||e.moneyTransfer||e.moneyRequest||e.miniApps&&e.miniApps.slice(-1)[0]||e.article||e.audioPlaylist||e.podcast||e.audios&&e.audios.slice(-1)[0]||e.voice||e.docs&&e.docs.slice(-1)[0]||e.geo||e.story||e.market||e.inviteLink||e.link||e.graffiti||e.videos&&e.videos.slice(-1)[0]||e.photos&&e.photos.slice(-1)[0]||e.videoMessage||e.sticker||e.finishedCall||e.activeCall||e.gift||null}function m(e,t){t.photos&&(e.photos=[].concat((0,n.default)(e.photos||[]),(0,n.default)(t.photos))),t.videos&&(e.videos=[].concat((0,n.default)(e.videos||[]),(0,n.default)(t.videos))),t.audios&&(e.audios=[].concat((0,n.default)(e.audios||[]),(0,n.default)(t.audios))),t.docs&&(e.docs=[].concat((0,n.default)(e.docs||[]),(0,n.default)(t.docs))),t.poll&&(e.poll=t.poll)}function _(e,t){switch(t.kind){case"Audio":if(!e.audios)break;var r=(0,o.toNonEmpty)(e.audios.filter((function(e){return e.id!==t.id})));r?e.audios=r:delete e.audios;break;case"Doc":if(!e.docs)break;var n=(0,o.toNonEmpty)(e.docs.filter((function(e){return e.id!==t.id})));n?e.docs=n:delete e.docs;break;case"Photo":if(!e.photos)break;var i=(0,o.toNonEmpty)(e.photos.filter((function(e){return e.id!==t.id})));i?e.photos=i:delete e.photos;break;case"Video":if(!e.videos)break;var a=(0,o.toNonEmpty)(e.videos.filter((function(e){return e.id!==t.id})));a?e.videos=a:delete e.videos;break;case"Voice":e.voice&&delete e.voice;break;case"Poll":e.poll&&delete e.poll;break;default:(0,o.exhaustivenessCheck)(t)}}function g(e){return e.startsWith(s.CHAT_INVITE_LINK_URL_BASE)||e.startsWith(s.VKME_CHAT_INVITE_LINK_URL_BASE)}function y(e){return e.startsWith(s.CALL_JOIN_LINK_URL_BASE)}function b(e,t,r){var n=t.currentPosition,i=t.newPosition;switch(r){case"photos":var a=e[r];if(!a)return;var s=a[n];if(!s)return;a.splice(n,1),a.splice(i,0,s),e[r]=a;break;case"videos":var c=e[r];if(!c)return;var d=c[n];if(!d)return;c.splice(n,1),c.splice(i,0,d),e[r]=c;break;case"audios":var u=e[r];if(!u)return;var l=u[n];if(!l)return;u.splice(n,1),u.splice(i,0,l),e[r]=u;break;case"docs":var f=e[r];if(!f)return;var p=f[n];if(!p)return;f.splice(n,1),f.splice(i,0,p),e[r]=f;break;default:(0,o.exhaustivenessCheck)(r)}}function k(e){for(var t=e.angle-90,r=e.points,n=[],i=0;i<r.length;i++){var o=r[i],a=100*i/(r.length-1);n.push("".concat(o," ").concat(a,"%"))}return"linear-gradient(".concat(t,"deg, ").concat(n.join(", "),")")}function w(e){return e?[e.title.length,e.voted?"0":"1",e.answers.map((function(e){return e.id})).join(",")].join("-"):""}},73974:(e,t,r)=>{"use strict";function n(e,t,r){return encodeURIComponent("".concat("app"+e+(r?"_"+r:""),"#").concat(t))}function i(e){return e}r.d(t,{createAppUrl:()=>n,resolveId:()=>i})},94170:(e,t,r)=>{"use strict";function n(e){return!Number.isNaN(e)&&e||(e=0),e}r.d(t,{resolveId:()=>n})},78664:(e,t,r)=>{"use strict";function n(e){return Number.isNaN(e)&&(e=0),e}function i(e){return Number.isNaN(e)&&(e=0),e}r.d(t,{resolveStickerPackId:()=>n,resolveStickerId:()=>i})},47860:(e,t,r)=>{"use strict";r.d(t,{dictionaryLatinConvert:()=>p,toTranslit:()=>v,toLocalCase:()=>h});var n=r(56568),i=r(22559);function o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,o=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw o}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d={u1072:"a",u1073:"b",u1074:"v",u1075:"g",u1076:"d",u1077:"e",u1105:"yo",u1078:"zh",u1079:"z",u1080:"i",u1081:"y",u1082:"k",u1083:"l",u1084:"m",u1085:"n",u1086:"o",u1087:"p",u1088:"r",u1089:"s",u1090:"t",u1091:"u",u1092:"f",u1093:"kh",u1094:"ts",u1095:"ch",u1096:"sh",u1097:"shch",u1098:"'",u1099:"y",u1100:"'",u1101:"e",u1102:"yu",u1103:"ya"},u=c(c({},d),{},{u1093:"h",u1097:"sh",u1098:"",u1100:"",u1105:"e"}),l={u102:"а",u44:"б",u100:"в",u117:"г",u108:"д",u116:"е",u92:"ё",u59:"ж",u112:"з",u98:"и",u113:"й",u114:"к",u107:"л",u118:"м",u121:"н",u106:"о",u103:"п",u104:"р",u99:"с",u110:"т",u101:"у",u97:"ф",u91:"х",u119:"ц",u120:"ч",u105:"ш",u111:"щ",u93:"ъ",u109:"ь",u115:"ы",u39:"э",u46:"ю",u122:"я",u60:"б",u126:"ё",u58:"ж",u123:"х",u125:"ъ",u34:"э",u62:"ю",u64:'"',u35:"№",u36:";",u37:"%",u94:":",u38:"?",u63:",",u47:"."},f={yo:"ё",YO:"Ё",zh:"ж",ZH:"Ж",kh:"х",KH:"Х",ts:"ц",TS:"Ц",ch:"ч",CH:"Ч",sch:"щ",SCH:"Щ",shch:"щ",SHCH:"Щ",sh:"ш",SH:"Ш",eh:"э",EH:"Э",yu:"ю",YU:"Ю",ya:"я",YA:"Я","'":"ь",a:"а",A:"А",b:"б",B:"Б",v:"В",g:"г",G:"Г",d:"д",D:"Д",e:"е",E:"Е",z:"з",Z:"З",i:"и",I:"И",j:"й",J:"Й",k:"к",K:"К",l:"л",L:"Л",m:"м",M:"М",n:"н",N:"Н",o:"о",O:"О",p:"п",P:"Р",r:"р",R:"Р",s:"с",S:"С",t:"т",T:"Т",u:"у",U:"У",f:"ф",F:"Ф",h:"х",H:"Х",c:"ц",C:"Ц",y:"ы",Y:"Ы"};function p(e){return function(e){var t=e.dictionary,r=e.value;return Object.entries(t).reduce((function(e,t){var r=(0,n.default)(t,2),i=r[0],o=r[1];return e.replace(new RegExp(i,"g"),o)}),r)}({value:e.value,dictionary:f})}function v(e,t){e=e.toLowerCase().trim();var r=[d,u];return t&&r.push(l),r.reduce((function(t,r){var n=m(e,r);return n===e||t.includes(n)||t.push(n),t}),[])}function h(e){return m(e=e.toLowerCase().trim(),l)}function m(e,t){var r,n="",i=o(e);try{for(i.s();!(r=i.n()).done;){var a=r.value,s=t["u"+a.codePointAt(0)];n+=void 0!==s?s:a}}catch(e){i.e(e)}finally{i.f()}return n}},33600:(e,t,r)=>{"use strict";r.d(t,{create:()=>l,add:()=>f,search:()=>p,peerWords:()=>m});var n=r(80312),i=r(22559),o=r(47860),a=r(21705),s=r(40075);function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var u=Symbol("items");function l(){return(0,i.default)({},u,new Set)}function f(e,t,r){if(Array.isArray(t))t.forEach((function(t){return f(e,t,r)}));else{var n=r(t),i=n.id,o=n.strings;(0,s.getWordsVariants)(o).forEach((function(t){var r=e;r[u].add(i),Array.from(t.trim().toLowerCase()).forEach((function(e){var t=r[e];t||(t=r[e]=l()),t[u].add(i),r=t}))}))}return e}function p(e,t){var r=v(e,_(t)),i=v(e,_(o.toLocalCase(t))),a=v(e,o.toTranslit(t));return new Set([].concat((0,n.default)(r),(0,n.default)(i),(0,n.default)(a)))}function v(e,t){var r,i=null,o=c(t);try{for(o.s();!(r=o.n()).done;){var a=h(e,r.value);if(i){var s,d=c(i);try{for(d.s();!(s=d.n()).done;){var u=s.value;a.has(u)||i.delete(u)}}catch(e){d.e(e)}finally{d.f()}}else i=new Set((0,n.default)(a))}}catch(e){o.e(e)}finally{o.f()}return i||new Set}function h(e,t){var r,n=e,i=c(t.trim().toLowerCase());try{for(i.s();!(r=i.n()).done;){var o=n[r.value];if(!o)return new Set;n=o}}catch(e){i.e(e)}finally{i.f()}return n[u]}function m(e){var t=[];switch(e.kind){case"Chat":t.push.apply(t,(0,n.default)(_(e.title)));break;case"Group":e.screenName&&t.push(e.screenName),t.push.apply(t,(0,n.default)(_(e.name)));break;case"User":e.screenName&&t.push(e.screenName),t.push.apply(t,(0,n.default)(_(e.firstName))),t.push.apply(t,(0,n.default)(_(e.lastName)));break;case"Contact":t.push.apply(t,(0,n.default)(_(e.name)));break;default:(0,a.exhaustivenessCheck)(e)}return t}function _(e){return e.trim().toLowerCase().split(/\s+/g)}},40075:(e,t,r)=>{"use strict";r.d(t,{getWordsVariants:()=>a});var n=r(47860);function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e){var t,r=[],o=i(e);try{var a=function(){var e=t.value,i=e.replace(/ё/g,"е").replace(/Ё/g,"Е");i!==e&&r.push(i),n.toTranslit(e,!0).forEach((function(t){t!==e&&r.push(t)})),r.push(e)};for(o.s();!(t=o.n()).done;)a()}catch(e){o.e(e)}finally{o.f()}return r}},3460:(e,t,r)=>{"use strict";r.d(t,{UNKNOWN_SHAPE_ID:()=>g,fromApiAttach:()=>y,fromApiConvoAttach:()=>b,fromApiWallAttach:()=>k,fromApiWallReplyAttach:()=>w,fromApiDoc:()=>C,fromApiPhoto:()=>A,fromApiVideo:()=>P,fromApiAudio:()=>j,fromApiVoice:()=>M,fromApiPoll:()=>B,fromApiPollBackgroundGradient:()=>q,apiAttachWallOwnerId:()=>G});var n=r(16790),i=r(93209),o=r(22559),a=r(80312),s=r(51225),c=r(14432),d=r(80662),u=r(41450),l=r(21705),f=r(78399),p=["type","src"];function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return _(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var g=-1;function y(e,t,r){if(0===e.length)return{};var n,i,o,d,l,p,v,_,g,y,b,S,D,q,K={},z=function(e){K.unknown=[].concat((0,a.default)(K.unknown||[]),[{data:e,kind:"Unknown"}])},Y=m(e);try{for(Y.s();!(n=Y.n()).done;){var $=n.value;switch($.type){case"photo":if(!$.photo){z($);break}var J=A($.photo,r);if(!J){z($);break}K.photos=[].concat((0,a.default)(K.photos||[]),[J]);break;case"audio":if(!$.audio){z($);break}var X=j($.audio);K.audios=[].concat((0,a.default)(K.audios||[]),[X]);break;case"video":if(!$.video){z($);break}var Z=P($.video,r);if(!Z){z($);break}K.videos=[].concat((0,a.default)(K.videos||[]),[Z]);break;case"doc":if(!$.doc){z($);break}var Q=C($.doc);if(!Q){z($);break}K.docs=[].concat((0,a.default)(K.docs||[]),[Q]);break;case"link":if(!$.link){z($);break}var ee=I($.link);if(!ee){z($);break}if(s.isChatInviteLink(ee.url)&&ee.image){K.inviteLink=function(e){return e.image?h(h({},e),{},{image:e.image,kind:"InviteLink"}):void 0}(ee);break}K.link=ee;break;case"market":if(!$.market){z($);break}K.market={kind:"Market",id:(q=$.market).id,ownerId:q.owner_id,title:q.title,price:q.price.text,priceOld:q.price.old_amount_text,photo:q.thumb_photo};break;case"market_album":if(!$.market_market_album){z($);break}K.marketAlbum={kind:"MarketAlbum"};break;case"gift":if(!$.gift){z($);break}var te=E($.gift);if(!te){z($);break}K.gift=te;break;case"sticker":if(!$.sticker){z($);break}var re=(0,f.fromApiSticker)($.sticker);if(!re){z($);break}K.sticker=re;break;case"wall":if(!$.wall||!$.wall.from_id||!$.wall.id){z($);break}$.wall.geo&&($.wall.attachments=[].concat((0,a.default)($.wall.attachments||[]),[{type:"geo",geo:$.wall.geo}]));var ne=G($.wall);if(!ne){z($);break}K.wall={kind:"Wall",authorId:c.resolveId($.wall.from_id),ownerId:c.resolveId(ne),id:$.wall.id,date:1e3*($.wall.date||0),chunks:u.fromServerText($.wall.text||""),attaches:k($.wall)};break;case"wall_reply":if(!($.wall_reply&&$.wall_reply.from_id&&$.wall_reply.id&&$.wall_reply.post_id)){z($);break}var ie=G($.wall_reply);if(!ie){z($);break}K.wallReply={kind:"WallReply",id:$.wall_reply.id,postId:$.wall_reply.post_id,authorId:c.resolveId($.wall_reply.from_id),ownerId:c.resolveId(ie),parentsStack:$.wall_reply.parents_stack,date:1e3*($.wall_reply.date||0),chunks:u.fromServerText($.wall_reply.text||""),attaches:w($.wall_reply.attachments||[])};break;case"article":if(!$.article){z($);break}K.article=O($.article);break;case"poll":if(!$.poll){z($);break}K.poll=B($.poll);break;case"graffiti":if(!$.graffiti){z($);break}K.graffiti={kind:"Graffiti",imageUrl:$.graffiti.url,width:$.graffiti.width,height:$.graffiti.height};break;case"audio_message":if(!$.audio_message){z($);break}K.voice=M($.audio_message,t);break;case"audio_playlist":if(!$.audio_playlist){z($);break}K.audioPlaylist={kind:"AudioPlaylist",id:(D=$.audio_playlist).id,ownerId:D.owner_id,type:T[D.type],title:D.title,accessKey:D.access_key,image:x(D.photo,"photo")};break;case"podcast":if(!$.podcast){z($);break}K.podcast=(y=$.podcast,b=void 0,S=void 0,{kind:"Podcast",id:y.id,ownerId:y.owner_id,title:y.title,image:null!==(b=y.podcast_info)&&void 0!==b&&null!==(S=b.cover)&&void 0!==S&&S.sizes?F(y.podcast_info.cover.sizes):void 0});break;case"money_transfer":if(!$.money_transfer){z($);break}K.moneyTransfer={kind:"MoneyTransfer",text:$.money_transfer.amount.text};break;case"money_request":if(!$.money_request){z($);break}K.moneyRequest={kind:"MoneyRequest",id:(g=$.money_request).id,toId:g.to_id,fromId:g.from_id,text:g.amount.text,initUrl:g.init_url,isUserOwner:!!g.user_is_owner,isProcessed:!!g.processed};break;case"story":if(!$.story){z($);break}K.story={kind:"Story",id:(_=$.story).id,ownerId:_.owner_id,image:_.photo&&_.photo.sizes?U(_.photo.sizes):void 0,date:void 0!==_.date?1e3*_.date:void 0,available:!_.is_expired&&0!==_.can_see};break;case"geo":if(!$.geo||!$.geo.coordinates){z($);break}K.geo={kind:"Geo",coordinates:$.geo.coordinates,place:$.geo.place};break;case"call":if(!$.call){z($);break}K.finishedCall=(d=$.call,l=void 0,p=void 0,v=void 0,{kind:"FinishedCall",initiatorId:d.initiator_id,duration:d.duration,state:R(d),participants:{list:null===(l=d.participants)||void 0===l||null===(p=l.list)||void 0===p?void 0:p.map(c.resolveId),count:(null===(v=d.participants)||void 0===v?void 0:v.count)||0,coverList:N(d)}});break;case"group_call_in_progress":if(!$.group_call_in_progress){z($);break}K.activeCall=(i=$.group_call_in_progress,o=void 0,{kind:"ActiveCall",initiatorId:i.initiator_id,joinLink:i.join_link,participants:{list:null===(o=i.participants.list)||void 0===o?void 0:o.map(c.resolveId),count:i.participants.count||0,coverList:N(i)}});break;case"mini_app":if(!$.mini_app){z($);break}var oe=L($.mini_app);if(!oe){z($);break}K.miniApps=[].concat((0,a.default)(K.miniApps||[]),[oe]);break;case"donut_link":if(!$.donut_link){z($);break}var ae=V($.donut_link);if(!ae){z($);break}K.donutLink=ae;break;case"video_message":if(!$.video_message){z($);break}K.videoMessage=H($.video_message);break;case"widget":if(!$.widget){z($);break}K.widget=W($.widget);break;case"narrative":case"artist":case"event":case"curator":case"group":case"link_curator":case"video_playlist":z($);break;default:$.type;z($)}}}catch(e){Y.e(e)}finally{Y.f()}return K}function b(e){var t,r={},n=m(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;switch(i.attachment.type){case"photo":if(!i.attachment.photo)break;var o=A(i.attachment.photo,i.attachment.photo.access_key);if(!o)break;var a={attach:o,cmid:d.resolveCmid(i.message_id),messageId:d.resolveId(i.message_id),peerId:c.resolveId(i.from_id)};r.photos=(r.photos||[]).concat(a);break;case"audio":if(!i.attachment.audio)break;var s={attach:j(i.attachment.audio),cmid:d.resolveCmid(i.message_id),messageId:d.resolveId(i.message_id),peerId:c.resolveId(i.from_id)};r.audios=(r.audios||[]).concat(s);break;case"video":if(!i.attachment.video)break;var u=P(i.attachment.video,i.attachment.video.access_key);if(!u)break;var f={attach:u,cmid:d.resolveCmid(i.message_id),messageId:d.resolveId(i.message_id),peerId:c.resolveId(i.from_id)};r.videos=(r.videos||[]).concat(f);break;case"doc":if(!i.attachment.doc)break;var p=C(i.attachment.doc);if(!p)break;var v={attach:p,cmid:d.resolveCmid(i.message_id),messageId:d.resolveId(i.message_id),peerId:c.resolveId(i.from_id)};r.docs=(r.docs||[]).concat(v);break;case"link":if(!i.attachment.link)break;var h=I(i.attachment.link);if(!h)break;var _={attach:h,cmid:d.resolveCmid(i.message_id),messageId:d.resolveId(i.message_id),peerId:c.resolveId(i.from_id)};r.links=(r.links||[]).concat(_);break;case"audio_message":case"graffiti":case"market":case"share":case"wall":break;default:(0,l.exhaustivenessCheck)(i.attachment.type)}}}catch(e){n.e(e)}finally{n.f()}return r}function k(e){var t=e.geo,r=e.attachments,n=e.copy_history,i=e.access_key,a=[];t&&(null==r||r.push({type:"geo",geo:t}));var s,d=m(r||[]);try{for(d.s();!(s=d.n()).done;){var u=s.value;switch(u.type){case"photo":case"audio":case"video":case"doc":case"link":case"mini_app":case"sticker":case"market":case"article":case"poll":case"audio_playlist":case"podcast":case"market_album":case"donut_link":case"graffiti":a.push((0,o.default)({type:u.type},u.type,u[u.type]));break;case"geo":var l,f,p;if(!u.geo)break;var v=null===(l=u.geo.coordinates)||void 0===l?void 0:l.split(" ").map((function(e){return parseFloat(e)}));a.push({type:"geo",geo:h(h({},u.geo),{},{place:{title:null===(f=u.geo.place)||void 0===f?void 0:f.title,address:null===(p=u.geo.place)||void 0===p?void 0:p.address},coordinates:v&&v[0]&&v[1]?{latitude:v[0],longitude:v[1]}:void 0})});break;case"textlive":case"textpost":case"textpost_publish":case"posted_photo":case"note":case"app":case"page":case"album":case"event":case"situational_theme":case"group":case"artist":case"curator":case"photos_list":case"pretty_cards":case"narrative":break;default:u.type}}}catch(e){d.e(e)}finally{d.f()}var _=y(a,!1,i);if(null!=n&&n[0]){var g=G(n[0]);_.wallHistory={kind:"WallHistory",id:n[0].id||0,authorId:c.resolveId(n[0].from_id),ownerId:c.resolveId(g),date:1e3*(n[0].date||0),text:n[0].text||""}}return _}function w(e){var t,r=[],n=m(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;switch(i.type){case"photo":case"audio":case"video":case"doc":case"link":case"sticker":case"market":case"graffiti":r.push((0,o.default)({type:i.type},i.type,i[i.type]));break;case"market_market_album":r.push((0,o.default)({type:"market_album"},i.type,i[i.type]));break;case"note":case"page":break;default:i.type}}}catch(e){n.e(e)}finally{n.f()}return y(r,!1)}function I(e){if(e.title&&e.caption){var t=e.url,r=/^https:\/\/m\.vk\.com(.+)/;if(r.test(e.url)){var n=e.url.match(r);t=n&&n[1]?n[1]:t}return{kind:"Link",url:t,title:e.title,meta:e.caption,image:e.photo?U(e.photo.sizes||[]):void 0}}}function C(e){var t,r,n;if(e.url){var i=!(null===(t=e.preview)||void 0===t||null===(r=t.photo)||void 0===r||null===(n=r.sizes)||void 0===n||!n.length)&&U(e.preview.photo.sizes.map((function(e){return h(h({},e),{},{url:e.src})})));return h({kind:"Doc",id:e.id,ownerId:e.owner_id,title:e.title,size:e.size,ext:e.ext,date:e.date,url:e.url},i&&{image:i})}}function A(e,t){var r;if(e.sizes)return{kind:"Photo",accessKey:e.access_key,albumId:e.album_id,id:e.id,ownerId:e.owner_id,hasTags:e.has_tags,sizes:U(e.sizes),originalImage:null===(r=e.orig_photo)||void 0===r?void 0:r.url,messageAccessKey:t}}function P(e,t){if(e.id&&e.owner_id){var r=F(e.image||[{url:"",height:0,width:0}]);if(r)return{kind:"Video",accessKey:e.access_key,id:e.id,ownerId:e.owner_id,duration:e.duration,width:e.width,height:e.height,image:r,title:e.title,views:e.views||0,restriction:e.restriction,files:"files"in e?e.files:void 0,messageAccessKey:t,player:e.player,platform:e.platform}}}function O(e){var t,r;switch(e.state){case"available":case"banned":case"deleted":case"paid":case"protected":t=e.state;break;case void 0:t="unknown";break;default:e.state;t="unknown"}return e.photo?r=U(e.photo.sizes||[]):e.owner_photo&&(r=U([{type:"o",width:0,height:0,url:e.owner_photo}])),{kind:"Article",state:t,url:e.url||"",title:e.title||"",author:e.owner_name||"",meta:e.subtitle||"",image:r}}var S={thumb:[48,96,256,512],photo:[34,68,135,270,300,600,1200],unknown:[]};function x(e,t){if(e){var r=S[t].reduce((function(r,n){var i=e["".concat(t,"_").concat(n)];return i?(r.push({url:i,width:n,height:n}),r):r}),[]),n=(0,i.default)(r),o=n[0],s=n.slice(1);return o?[o].concat((0,a.default)(s)):void 0}}function E(e){var t=x(e,"thumb");if(t)return{kind:"Gift",id:e.id,isStickerStyle:!!e.is_stickers_style,image:t}}function j(e){return{kind:"Audio",id:e.id,ownerId:e.owner_id,artist:e.artist,title:e.title,subtitle:e.subtitle,url:e.url,duration:e.duration,albumId:e.album_id,trackCode:e.track_code,contentRestricted:e.content_restricted,albumPartNumber:e.album_part_number,accessKey:e.access_key}}function M(e,t){return{kind:"Voice",duration:e.duration,id:e.id,linkMp3:e.link_mp3,linkOgg:e.link_ogg,ownerId:e.owner_id,waveform:e.waveform,isListened:t,isTranscriptPossible:e.duration/60/60<1,transcription:D(e)}}function D(e){switch(e.transcript_state){case"done":var t;return{state:"done",text:null===(t=e.transcript)||void 0===t?void 0:t.trim(),updatedAt:e.transcript_update_time?1e3*e.transcript_update_time:void 0};case"error":case"in_progress":return{state:e.transcript_state};case void 0:return;default:(0,l.exhaustivenessCheck)(e.transcript_state)}}var T={0:"playlist",1:"album",2:"playlist",3:"playlist",4:"playlist",5:"playlist"};function U(e){return e.sort((function(e,t){return e.width-t.width})).reduce((function(e,t){var r=t.type,i=(t.src,(0,n.default)(t,p));return"s"!==r&&"m"!==r&&"x"!==r&&"o"!==r&&"p"!==r&&"q"!==r&&"r"!==r&&"y"!==r&&"z"!==r&&"w"!==r||(i.width&&i.height?e.set(r,i):e.set(r,h(h({},i),{},{width:200,height:200}))),e}),new Map)}function F(e){var t=e.sort((function(e,t){return e.width-t.width})).map((function(e){return{width:e.width,height:e.height,url:e.url}})),r=(0,i.default)(t),n=r[0],o=r.slice(1);if(n)return[n].concat((0,a.default)(o))}function N(e){var t,r=null===(t=e.participants)||void 0===t?void 0:t.list;return r?r.reduce((function(e,t){var r=c.resolveAnyId(t);return(c.isUserPeerId(r)||c.isGroupPeerId(r))&&e.push(r),e}),[]).slice(0,3):[]}function R(e){switch(e.state){case"reached":return"reached";case"canceled_by_initiator":return"canceledByInitiator";case"canceled_by_receiver":return"canceledByReceiver";default:(0,l.exhaustivenessCheck)(e.state)}}function L(e){if(e.app&&e.app.share_url&&e.app.webview_url){var t=(0,l.toNonEmpty)(e.images.map((function(e){var t=e.url,r=e.height;return{width:e.width,height:r,url:t}})));if(t){t.sort((function(e,t){return e.width-t.width}));var r=e.app.share_url.replace(/https:\/\/[a-z0-9_\-.]+\//,"");return{kind:"MiniApp",title:e.title,appLink:r,images:t,id:s.resolveMiniAppId(e.app.id),url:e.app.webview_url}}}}function V(e){var t,r,n=c.resolveId(e.owner_id);if(c.isGroupPeerId(n)&&null!==(t=e.action)&&void 0!==t&&t.url&&null!==(r=e.button.action)&&void 0!==r&&r.url&&e.button.title)return{kind:"DonutLink",ownerId:n,button:{action:{target:"internal",type:"open_url",url:e.button.action.url},title:e.button.title},donorsCount:e.donors.count,text:e.text,action:{target:"internal",type:"open_url",url:e.action.url}}}function B(e){var t,r;return{kind:"Poll",id:e.id,ownerId:c.resolveId(e.owner_id),authorId:void 0!==e.author_id?c.resolveId(e.author_id):c.resolveId(e.owner_id),title:e.question,anonymous:!!e.anonymous,endDate:1e3*e.end_date,answers:e.answers.map((function(t){var r;return{id:t.id,text:t.text,votes:t.votes,rate:t.rate,selected:!(null===(r=e.answer_ids)||void 0===r||!r.includes(t.id))}})),voted:!(null===(t=e.answer_ids)||void 0===t||!t.length),canVote:e.can_vote,canChangeVote:!e.disable_unvote,canEdit:e.can_edit,multiple:e.multiple,votes:e.votes,friends:(null===(r=e.friends)||void 0===r?void 0:r.map((function(e){return c.resolveId(e.id)})))||[],backgroundGradient:q(e.background),backgroundPhoto:K(e.photo)}}function q(e){if(e&&"gradient"===e.type){var t=e.points,r=e.angle;if(void 0!==t&&void 0!==r)return{id:e.id||0,points:t.map((function(e){return"#"+e.color})),angle:r}}}function K(e){if(e&&e.color&&e.images){var t=(0,l.toNonEmpty)(e.images.map((function(e){return{url:e.url,width:e.width,height:e.height}})));if(t)return{kind:"PollBackgroundPhoto",image:t,color:"#"+e.color}}}function G(e){var t,r=e.owner_id,n=e.source_id,i=e.to_id;return null!==(t=null!=r?r:n)&&void 0!==t?t:i}function H(e){if(e.id&&e.owner_id){var t=F(e.image||[{url:"",height:0,width:0}]);if(t)return{kind:"VideoMessage",id:e.id,ownerId:e.owner_id,duration:e.duration,shapeId:e.shape_id||g,image:t,files:e.files}}}function W(e){if(e.item.widget_id)return{kind:"Widget",id:e.item.widget_id}}},83906:(e,t,r)=>{"use strict";r.d(t,{fromApiKeyboard:()=>u,fromEngineKeyboard:()=>l,convertButtons:()=>p,fromApiMessageEvent:()=>h});var n=r(22559),i=r(33788),o=r(73974),a=r(14432),s=r(90831);function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){(0,n.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t){var r=f(e.buttons,e.inline),n=a.resolveId(e.author_id||t);return e.inline?{kind:"InlineKeyboard",authorId:n,buttons:r}:{kind:"InputKeyboard",authorId:n,buttons:r,oneTime:e.one_time}}function l(e,t){return e.inline?e.buttons?{kind:"InlineKeyboard",buttons:f(e.buttons,e.inline),authorId:a.resolveId(e.author_id||t)}:void 0:null!==(r=e.buttons)&&void 0!==r&&r.length?{kind:"InputKeyboardUpsertEvent",keyboard:{kind:"InputKeyboard",buttons:f(e.buttons,e.inline),authorId:a.resolveId(e.author_id||t),oneTime:e.one_time}}:{kind:"InputKeyboardDeleteEvent"};var r}function f(e,t){return e.map((function(e){return p(e,t)}))}function p(e,t){return e.map((function(e){return function(e,t){var r,n="positive"===(r=e.color)?"commerce":"negative"===r?"destructive":"primary"===r?r:"secondary";switch(e.action.type){case"text":case"callback":return{type:e.action.type,label:(0,i.decodeHTMLEntities)(e.action.label||""),payload:e.action.payload||"",color:n};case"open_link":return{type:e.action.type,link:e.action.link,label:(0,i.decodeHTMLEntities)(e.action.label||""),payload:e.action.payload||"",color:n};case"location":return{type:e.action.type,payload:e.action.payload||"",color:n};case"vkpay":return{type:e.action.type,payload:e.action.payload||"",hash:e.action.hash||"",url:o.createAppUrl(s.VK_PAY_APP_ID,e.action.hash||"")};case"open_app":return{type:e.action.type,payload:e.action.payload||"",label:(0,i.decodeHTMLEntities)(e.action.label||""),hash:e.action.hash||"",appId:e.action.app_id||0,ownerId:e.action.owner_id||0,color:n,url:o.createAppUrl(e.action.app_id,e.action.hash||"",e.action.owner_id)};case"open_photo":return;default:return void e.action}}(e)})).filter(v)}function v(e){return void 0!==e}var h=function(e,t,r){var n=r.event_id,i=r.action,s=r.owner_id,c=o.resolveId(n),u=a.resolveId(s);if(!i)return{id:c,type:"null",ownerId:u,peerId:e.id};switch(i.type){case"show_snackbar":return d(d({},i),{},{id:c,ownerId:u,title:a.name(e),photo:t.photo50,peerId:e.id});case"open_link":return d(d({},i),{},{id:c,ownerId:u,title:a.name(e),peerId:e.id});default:return{id:c,type:i.type,ownerId:u,url:(0,o.createAppUrl)(i.app_id,i.hash,u),peerId:e.id}}}},19117:(e,t,r)=>{"use strict";r.d(t,{fromApiChannel:()=>a});var n=r(16352),i=r(30966),o=r(92954),a=function(e,t){var r,a,s,c,d=e.channel,u=e.last_message,l=u&&(0,o.fromApiPost)(u).post,f=[];l&&(f=l.cmid>1?[{kind:"GapItem",fromCmid:i.resolveCmid(1),toCmid:i.resolveCmid(l.cmid-1)},{kind:"PostItem",post:l}]:[{kind:"PostItem",post:l}]);var p=!d.user_data.notification_settings.is_enabled||(d.user_data.notification_settings.disable_duration||0)>0;return{kind:"Channel",id:n.resolveId(d.channel_id),unreadCount:(null===(r=d.user_data.read_state)||void 0===r?void 0:r.unread_count)||0,isArchived:(null===(a=d.user_data)||void 0===a?void 0:a.is_archived)||!1,isMuted:p,notificationsDisabledUntil:d.user_data.notification_settings.disable_duration||0,inReadCmid:i.resolveCmid((null===(s=d.user_data)||void 0===s||null===(c=s.read_state)||void 0===c?void 0:c.read_up_to_cmid)||0),majorSortId:d.sort_id.major_id,minorSortId:d.sort_id.minor_id,membersCount:t.members_count||0,isMember:Boolean(t.is_member),isAdmin:Boolean(t.is_admin),photos:{photo50:t.photo_50,photo100:t.photo_100},name:t.name||"",activity:t.activity||"",isVerified:Boolean(t.verified),screenName:t.screen_name,history:f,pending:{},locks:{loading:!1,cleanUp:0}}}},89032:(e,t,r)=>{"use strict";r.d(t,{fromApiConvo:()=>v,fromLongpollPushSettings:()=>h});var n=r(80312),i=r(22559),o=r(14432),a=r(60202),s=r(80662),c=r(96543),d=r(83906),u=r(41450);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p={18:"peer_deleted",900:"peer_blacklisted_by_me",901:"peer_blacklisted",902:"peer_blacklisted",915:"disabled_by_community",916:"disabled_by_peer",917:"kicked",918:"no_access",922:"no_access",925:"no_access",932:"no_access",945:"chat_unsupported",946:"chat_unsupported",203:"disabled_by_peer"};function v(e,t){var r,i,l,p=t&&(0,c.fromApiMessage)(t).message,v=e.current_keyboard&&(0,d.fromApiKeyboard)(e.current_keyboard);if("InlineKeyboard"===(null==v?void 0:v.kind))throw new Error("Не может прийти инлайн клавиатура для сообщения");var h,y,b,k,w,I={majorSortId:(null===(r=e.sort_id)||void 0===r?void 0:r.major_id)||0,minorSortId:(null===(i=e.sort_id)||void 0===i?void 0:i.minor_id)||0,unreadCount:e.unread_count||0,isMarkedUnread:!!e.is_marked_unread,isArchived:!!e.is_archived,inReadBy:s.resolveCmid(e.in_read_cmid),outReadBy:s.resolveCmid(e.out_read_cmid),folderIds:new Set((null===(l=e.folder_ids)||void 0===l?void 0:l.map(a.resolveId))||[]),isNew:!!e.is_new,canWrite:_(e),currentKeyboard:v,push:m(e.push_settings),persistedCmid:s.resolveCmid(null==p?void 0:p.cmid),persisted:p?new Map([[p.cmid,f(f({},p),{},{olderId:s.resolveCmid(),newerId:s.resolveCmid()})]]):new Map,queuedId:s.resolveRandomId(),queued:new Map,unreadExpireables:new Set((e.expire_cmids||[]).map(s.resolveCmid)),hasMore:e.last_message_id>0,convoBanner:e.conversation_bar&&(h=e.conversation_bar,{icon:null!==(y=h.icon)&&void 0!==y?y:"",name:h.name,title:null!==(b=h.title)&&void 0!==b?b:"",chunks:u.fromServerText(h.text),canHide:h.can_hide||!0,buttons:(h.buttons||[]).map((function(e){var t,r,n;return{callbackData:null!==(t=null==e?void 0:e.callback_data)&&void 0!==t?t:"",mode:null!==(r=null==e?void 0:e.style)&&void 0!==r?r:e.layout,link:null!==(n=null==e?void 0:e.link)&&void 0!==n?n:"",text:e.text,hideOnAction:!!e.hide_on_action,type:e.type}}))})},C=o.resolveId(e.peer.id);switch(e.peer.type){case"user":if(!o.isUserPeerId(C))return null;if(void 0!==e.message_request_data){var A=e.message_request_data.status;return"pending"===A?{convo:f(f({},I),{},{kind:"MessageRequestUserConvo",peerId:C,MRStatus:A})}:null}return{convo:f(f({},I),{},{kind:"UserConvo",peerId:C})};case"chat":var P,O,S,x,E,j,M,D;if(!o.isChatPeerId(C))return null;if(!e.chat_settings)throw new Error("TODO chat convo has to has chat settings");var T=e.chat_settings.owner_id&&0!==e.chat_settings.owner_id?o.resolveId(e.chat_settings.owner_id):void 0,U=T&&(o.isUserPeerId(T)||o.isGroupPeerId(T))?T:void 0,F=f(f({},I),{},{peerId:C,ownerId:U,unreadMentions:new Set((e.mention_cmids||[]).map(s.resolveCmid)),membersCount:(null===(P=e.chat_settings)||void 0===P?void 0:P.members_count)||0,state:null===(O=e.chat_settings)||void 0===O?void 0:O.state,isCasper:!!e.chat_settings.is_disappearing,isCommunityChat:!!T&&o.isGroupPeerId(T),isDonut:!!e.chat_settings.is_donut,activeCall:g(e.call_in_progress),pinnedMessage:e.chat_settings.pinned_message?(0,c.fromApiPinnedMessage)(e.chat_settings.pinned_message):void 0,acl:(w=e.chat_settings.acl,{canChangeInfo:w.can_change_info,canChangeInviteLink:w.can_change_invite_link,canChangePin:w.can_change_pin,canInvite:w.can_invite,canPromoteUsers:w.can_promote_users,canSeeInviteLink:w.can_see_invite_link,canModerate:w.can_moderate,canCopyChat:w.can_copy_chat,canCall:w.can_call,canUseMassMentions:w.can_use_mass_mentions,canChangeServiceType:Boolean(w.can_change_service_type),canChangeStyle:Boolean(w.can_change_style)}),permissions:e.chat_settings.permissions?(k=e.chat_settings.permissions,{invite:k.invite||"all",change_info:k.change_info||"all",change_pin:k.change_pin||"all",use_mass_mentions:k.use_mass_mentions||"all",see_invite_link:k.see_invite_link||"all",call:k.call||"all",change_style:k.change_style||"all",change_admins:k.change_admins||"owner"}):void 0,isService:Boolean(e.chat_settings.is_service),adminIds:new Set([].concat((0,n.default)([T]||0),(0,n.default)(e.chat_settings.admin_ids||[])).map(o.resolveId)),memberIds:new Set([]),invitedIds:new Set([])}),N={kind:"Chat",id:C,title:(null===(S=e.chat_settings)||void 0===S?void 0:S.title)||"",photo50:null===(x=e.chat_settings.photo)||void 0===x?void 0:x.photo_50,photo100:null===(E=e.chat_settings.photo)||void 0===E?void 0:E.photo_100,photo200:null===(j=e.chat_settings.photo)||void 0===j?void 0:j.photo_200,hasDefaultPhoto:(null===(M=e.chat_settings.photo)||void 0===M?void 0:M.is_default_photo)||(null===(D=e.chat_settings.photo)||void 0===D?void 0:D.is_default_call_photo),canCall:e.chat_settings.acl.can_call};if(void 0!==e.message_request_data){var R=e.message_request_data,L=R.status,V=R.inviter_id;return"pending"===L&&void 0!==V?{convo:f(f({},F),{},{kind:"MessageRequestChatConvo",inviterPeerId:o.resolveId(V),MRStatus:L}),peer:N}:null}return"business_notify"===e.special_service_type?{convo:f(f({},F),{},{kind:"BusinessNotify"}),peer:N}:{convo:f(f({},F),{},{kind:"ChatConvo"}),peer:N};case"group":return o.isGroupPeerId(C)?{convo:f(f({},I),{},{peerId:C,kind:"GroupConvo"})}:null;case"email":return null;case"contact":return o.isContactPeerId(C)?{convo:f(f({},I),{},{peerId:C,kind:"ContactConvo"})}:null;default:e.peer.type;return null}}function h(e){var t=Number(e[1].disabled_until);switch(t){case 0:return{mode:"everything",disabledUntil:0};case-1:return{mode:"every-mention",disabledUntil:1/0};default:return{mode:"every-mention",disabledUntil:1e3*t}}}function m(e){var t={mode:"everything",disabledUntil:0};return e?(e.disabled_forever?t={mode:"every-mention",disabledUntil:1/0}:e.disabled_until&&(t={mode:"every-mention",disabledUntil:1e3*e.disabled_until}),"everything"!==t.mode&&(e.disabled_mass_mentions&&(t=f(f({},t),{},{mode:"direct-mention"})),e.disabled_mentions&&(t=f(f({},t),{},{mode:"nothing"}))),t):t}function _(e){var t,r=e.can_write;return"chat"===e.peer.type&&"rejected"===(null===(t=e.message_request_data)||void 0===t?void 0:t.status)?{allowed:!1,reason:"mr_rejected"}:null!=r&&r.allowed?{allowed:!0}:{allowed:!1,reason:(null==r?void 0:r.reason)&&p[r.reason]||"unknown"}}function g(e){if(e)return{participants:{list:(e.participants.list||[]).reduce((function(e,t){var r=o.resolveAnyId(t);return(o.isUserPeerId(r)||o.isGroupPeerId(r))&&e.push(r),e}),[]),count:e.participants.count||0},joinLink:e.join_link,canFinishCall:Boolean(e.can_finish_call),hasLink:Boolean(e.has_link)}}},90917:(e,t,r)=>{"use strict";r.d(t,{fromApiFolder:()=>i});var n=r(60202);function i(e){return{id:n.resolveId(e.id),name:e.name,unreadCount:0,unreadUnmutedCount:0,all:{peerIds:new Set,boundaryMinorId:1/0,hasMore:!0},unread:{peerIds:new Set,boundaryMinorId:1/0,hasMore:!0}}}},96543:(e,t,r)=>{"use strict";r.d(t,{fromApiMessage:()=>b,fromApiPinnedMessage:()=>P,fromEngineMessage:()=>k});var n=r(80312),i=r(56568),o=r(81385),a=r(3460),s=r(80662),c=r(14432),d=r(41450),u=r(21705),l=r(83906),f=r(22559),p=r(16790),v=["buttons","photo","action"];function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){(0,f.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _(e,t){var r;return{kind:"carousel",elements:(null===(r=e.elements)||void 0===r?void 0:r.map((function(e){return function(e,t){var r=e.buttons,n=e.photo,i=e.action,o=(0,p.default)(e,v),s=n?(0,a.fromApiPhoto)(n,t):null,c=m(m({buttons:r?(0,l.convertButtons)(r,!0):[]},s&&{photo:s}),o),d=m(m({},c),{},{kind:"simple"});if(!i)return d;switch(i.type){case"open_photo":return n&&s?m(m({},c),{},{kind:"photo",photo:s}):d;case"open_link":return m(m({},c),{},{kind:"link",link:i.link});default:return d}}(e,t)})))||[]}}function g(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function b(e){if(e.action)return{message:{kind:"Service",id:s.resolveId(e.id),action:C({apiAction:e.action,apiAttaches:e.attachments}),peerId:c.resolveId(e.peer_id),cmid:s.resolveCmid(e.conversation_message_id),authorId:c.resolveId(e.from_id),sentAt:1e3*e.date,isOut:1===e.out,deleteTTL:void 0!==e.ttl?1e3*e.ttl:void 0},mentions:{hasDirect:!1,hasMass:!1}};var t=c.resolveId(e.peer_id);if(e.is_expired)return{message:{kind:"Expired",id:s.resolveId(e.id),cmid:s.resolveCmid(e.conversation_message_id),peerId:c.resolveId(e.peer_id),authorId:c.resolveId(e.from_id),isOut:1===e.out,sentAt:1e3*e.date},mentions:{hasDirect:!1,hasMass:!1}};var r=e.keyboard&&(0,l.fromApiKeyboard)(e.keyboard);if("InputKeyboard"===(null==r?void 0:r.kind))throw new Error("Кажется из апи пришла не инлайн клавиатура для сообщения");var n=s.resolveCmid(e.conversation_message_id);return{message:{kind:"Normal",id:s.resolveId(e.id),randomId:s.resolveRandomId(e.random_id),cmid:n,peerId:t,authorId:c.resolveId(e.from_id),chunks:d.fromServerText(e.text),isOut:1===e.out,isImportant:!!e.important,sentAt:1e3*e.date,updatedAt:e.update_time&&1e3*e.update_time,attaches:(0,a.fromApiAttach)(A(e),!!e.was_listened,"mail".concat(e.id)),keyboard:r,forwardedMessages:I(e.fwd_messages,t,n),replyMessage:e.reply_message?w(e.reply_message,t,n):void 0,expireTTL:e.expire_ttl?1e3*e.expire_ttl:void 0,deleteTTL:void 0!==e.ttl?1e3*e.ttl:void 0,template:e.template?_(e.template,"mail".concat(e.id)):void 0},mentions:{hasDirect:!1,hasMass:!1}}}function k(e,t,r){var n,f,p,v,h,m,_,y,b,k;switch(e[0]){case 4:var w=(0,i.default)(e,11);n=w[1],f=w[2],p=w[4],v=w[5],h=w[6],m=w[7],_=w[8],y=w[9],k=w[10];break;case 10004:var I=(0,i.default)(e,11);k=I[1],f=I[2],p=I[4],v=I[5],h=I[6],m=I[7],_=I[8],y=I[9],n=I[10];break;case 5:var A=(0,i.default)(e,11);n=A[1],f=A[2],p=A[3],v=A[4],h=A[5],m=A[6],_=A[7],y=A[8],k=A[9],b=A[10];break;case 10005:var P=(0,i.default)(e,11);k=P[1],f=P[2],p=P[3],v=P[4],h=P[5],m=P[6],_=P[7],y=P[8],n=P[9],b=P[10];break;case 18:var O=(0,i.default)(e,11);n=O[1],f=O[2],p=O[3],v=O[4],h=O[5],m=O[6],_=O[7],y=O[8],k=O[9],b=O[10];break;case 10018:var S=(0,i.default)(e,11);k=S[1],f=S[2],p=S[3],v=S[4],h=S[5],m=S[6],_=S[7],y=S[8],n=S[9],b=S[10];break;default:(0,u.exhaustivenessCheck)(e)}var x,E=c.resolveId(p),j=s.convertFlags(f),M=j.isOut,D=j.isImportant,T=j.noPush,U=j.isVoiceListened,F=M||c.isFavorites(E,t);if(x=void 0!==m.from?c.resolveId(Number(m.from)):F?t:E,m.source_act)return{message:{kind:"Service",id:s.resolveId(n),cmid:s.resolveCmid(k),peerId:E,authorId:x,action:C({apiAction:{conversation_message_id:m.source_chat_local_id?Number(m.source_chat_local_id):void 0,message:m.source_message,type:m.source_act,member_id:m.source_mid?Number(m.source_mid):void 0,text:m.source_text,old_text:m.source_old_text,style:m.source_style}}),deleteTTL:void 0!==m.ttl?1e3*Number(m.ttl):void 0,sentAt:1e3*v,isOut:F},mentions:{hasDirect:!1,hasMass:!1},noPush:T};if("1"===m.is_expired)return{message:{kind:"Expired",id:s.resolveId(n),cmid:s.resolveCmid(k),isOut:F,peerId:E,authorId:x,sentAt:1e3*v},mentions:{hasDirect:!1,hasMass:!1},noPush:!0};var N,R={hasDirect:!1,hasMass:!1},L=g(m.marked_users||[]);try{for(L.s();!(N=L.n()).done;){var V=N.value;if(V[0]===o.IEngine.MarkedType.Mention)switch(V[1]){case"all":R.hasMass=R.hasMass||x!==t;break;case"online":R.hasMass=R.hasMass||V[2].includes(t);break;default:R.hasDirect=V[1].includes(t)}}}catch(e){L.e(e)}finally{L.f()}var B,q={};if("sticker"!==_.attach1_type&&"audiomsg"!==_.attach1_kind||!_.attachments)void 0!==_.attach1_type&&(q={unknown:[{data:_,kind:"Unknown"}]});else{var K=JSON.parse(_.attachments);Array.isArray(K)&&(q=(0,a.fromApiAttach)(K,U,"mail".concat(n)))}if(void 0!==_.reply){var G=JSON.parse(_.reply),H=r(s.resolveCmid(G.conversation_message_id));H&&(B=s.toForeign({message:H,rootPeerId:E,rootCmid:s.resolveCmid(k)}))}var W,z,Y=m.keyboard?(0,l.fromEngineKeyboard)(m.keyboard,x):void 0;return"InlineKeyboard"===(null==Y?void 0:Y.kind)?W=Y:z=Y,{message:{kind:"Normal",id:s.resolveId(n),cmid:s.resolveCmid(k),randomId:s.resolveRandomId(y),peerId:E,authorId:x,chunks:d.fromServerText(h),isOut:F,isImportant:D,sentAt:1e3*v,updatedAt:b?1e3*b:void 0,expireTTL:m.expire_ttl?1e3*Number(m.expire_ttl):void 0,deleteTTL:void 0!==m.ttl?1e3*Number(m.ttl):void 0,attaches:q,replyMessage:B,keyboard:W},mentions:R,noPush:T,keyboardEvent:z}}function w(e,t,r){var n,i;return e.peer_id&&(n=c.resolveId(e.peer_id)),e.id&&(i=s.resolveId(e.id)),{kind:"Foreign",id:i,peerId:n,rootPeerId:t,rootCmid:r,cmid:s.resolveCmid(e.conversation_message_id),authorId:c.resolveId(e.from_id),chunks:d.fromServerText(e.text),sentAt:1e3*e.date,updatedAt:e.update_time&&1e3*e.update_time,attaches:(0,a.fromApiAttach)(A(e),!!e.was_listened,e.id?"mail".concat(e.id):void 0),forwardedMessages:I(e.fwd_messages,t,r),replyMessage:e.reply_message?w(e.reply_message,t,r):void 0}}function I(e,t,r){if(e&&0!==e.length){var n,i,o=g(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;n?n.push(w(a,t,r)):n=[w(a,t,r)]}}catch(e){o.e(e)}finally{o.f()}return n}}function C(e){var t=e.apiAction,r=e.apiAttaches,n={type:"unknown"};switch(t.type){case"chat_create":return t.text?{type:t.type,title:t.text}:n;case"chat_title_update":return t.text&&t.old_text?{type:t.type,title:t.text,oldTitle:t.old_text}:n;case"chat_photo_remove":case"chat_screenshot":case"chat_group_call_started":case"chat_invite_user_by_link":case"chat_invite_user_by_call_join_link":case"chat_kick_don":return{type:t.type};case"chat_pin_message":case"chat_unpin_message":return{type:t.type,cmid:s.resolveCmid(t.conversation_message_id),chunks:t.message?d.fromServerText(t.message):[]};case"chat_photo_update":var i=null==r?void 0:r.find((function(e){return"photo"===e.type})),o=null==i?void 0:i.photo;if(!o)return n;var u=(0,a.fromApiPhoto)(o);return u?{type:t.type,photo:u}:n;case"chat_invite_user":case"chat_kick_user":case"accepted_message_request":if(!t.member_id)return n;var l=c.resolveId(t.member_id);return c.isUserPeerId(l)||c.isGroupPeerId(l)?{type:t.type,peerId:l}:n;case"chat_invite_user_by_message_request":case"chat_invite_user_by_call":case"chat_kick_user_call_block":if(!t.member_id)return n;var f=c.resolveId(t.member_id);return c.isUserPeerId(f)?{type:t.type,peerId:f}:n;case"conversation_style_update":case"conversation_style_update_action":return{type:t.type,style:t.style};case"custom":return t.message?{type:t.type,chunks:d.fromServerText(t.message)}:n;default:t.type;return n}}function A(e){var t=e.attachments,r=void 0===t?[]:t,i=e.geo;return i?[].concat((0,n.default)(r),[{type:"geo",geo:i}]):r}function P(e){var t,r=c.resolveId(e.peer_id),n=s.resolveCmid(e.conversation_message_id),i=c.resolveId(e.from_id);return e.id&&(t=s.resolveId(e.id)),{kind:"Pinned",id:t,cmid:n,peerId:r,authorId:i,chunks:d.fromServerText(e.text),sentAt:1e3*e.date,forwardedMessages:e.fwd_messages?I(e.fwd_messages,r,n):void 0,replyMessage:e.reply_message?w(e.reply_message,r,n):void 0,attaches:(0,a.fromApiAttach)(e.attachments||[],!1)}}},4850:(e,t,r)=>{"use strict";r.d(t,{fromApiUser:()=>s,fromApiGroup:()=>c,fromApiContact:()=>d,fromApiAnonym:()=>u,convertPlatform:()=>l});var n=r(56568),i=r(14432),o=[6482950,6481715,6146827],a={1:"mobile",2:"mobile",3:"mobile",4:"mobile",5:"mobile",6:"other",7:"other"};function s(e){var t,r,a,s,c,d,u={0:"unfamiliar",1:"outgoingRequest",2:"incomingRequest",3:"friends"},l="other";null!==(t=e.online_info)&&void 0!==t&&t.is_mobile&&(l="mobile"),o.includes((null===(r=e.online_info)||void 0===r?void 0:r.app_id)||0)&&(l="vkme");var f=i.resolveRealId("User",e.id),p=Boolean(e.blacklisted),v=e.photo_id?e.photo_id.split("_"):[],h=(0,n.default)(v,2)[1],m=h?parseInt(h):null;return{user:{kind:"User",id:f,firstName:e.first_name,firstNameGen:e.first_name_gen||e.first_name,firstNameAcc:e.first_name_acc||e.first_name,lastName:e.last_name,lastNameGen:e.last_name_gen||e.last_name,lastNameAcc:e.last_name_acc||e.last_name,screenName:e.screen_name,sex:void 0!==e.sex?{0:"unknown",1:"female",2:"male"}[e.sex]:"unknown",photoId:m&&!isNaN(m)?m:void 0,photo50:e.photo_50,photo100:e.photo_100,photo200:e.photo_200,lastSeen:{isVisible:!(null===(a=e.online_info)||void 0===a||!a.visible),at:(null===(s=e.online_info)||void 0===s?void 0:s.last_seen)&&1e3*e.online_info.last_seen,platform:l},isVerified:Boolean(e.verified),isBlacklisted:p,isBlacklistedByMe:Boolean(e.blacklisted_by_me),isDeactivated:Boolean(e.deactivated),canCall:Boolean(e.can_call),canChangeFriendship:1===e.can_send_friend_request,canInviteToChats:!!e.can_invite_to_chats,canMessage:1===e.can_write_private_message,hasDefaultPhoto:1!==e.has_photo,followersCount:e.followers_count||0,friendship:void 0!==e.friend_status?u[e.friend_status]:u[0],mutualFriends:p?{hint:[],count:0}:void 0,contactName:e.contact_name,occupation:e.occupation,bdate:e.bdate,city:e.city},isOnline:!(null===(c=e.online_info)||void 0===c||!c.visible||null===(d=e.online_info)||void 0===d||!d.is_online)}}function c(e){var t,r=i.resolveRealId("Group",e.id);if(!e.type)throw new Error("fromApiGroup содержит некорректный тип ".concat(e.type));var n={0:"notMember",1:"member",2:"unsure",3:"declined",4:"outgoingRequest",5:"incomingRequest"}[e.member_status||0];return{kind:"Group",id:r,type:e.type,name:e.name,screenName:e.screen_name,photo50:e.photo_50,photo100:e.photo_100,photo200:e.photo_200,activity:e.activity,memberCount:e.members_count||0,membership:n,isDeactivated:Boolean(e.deactivated),isVerified:1===e.verified,isClosed:Boolean(e.is_closed),canMessage:1===e.can_message,canChangeMembership:0!==(null===(t=e.ban_info)||void 0===t?void 0:t.end_date)&&(0===e.is_closed||"member"===n||"incomingRequest"===n),mutualFriends:2===e.is_closed&&"member"!==n?{hint:[],count:0}:void 0,isBlacklistedByMe:1===e.is_messages_blocked}}function d(e){var t=i.resolveRealId("Contact",e.id),r=i.resolveId(e.user_id);return{kind:"Contact",id:t,name:e.name,userId:r,phone:e.phone,canWrite:e.can_write,photo50:e.photo_50,lastSeen:e.last_seen_status}}function u(e){var t=i.resolveAnyId(e.id);if(i.isAnonymPeerId(t))return{id:t,kind:"Anonym",name:e.name,photo50:e.photo_50,photo100:e.photo_100,photo200:e.photo_200,photo400:e.photo_400}}function l(e,t){var r=a[e]||"other";return o.includes(t)&&(r="vkme"),r}},92954:(e,t,r)=>{"use strict";r.d(t,{fromApiPost:()=>v});var n=r(80312),i=r(22559),o=r(30966),a=r(41450),s=r(14432),c=r(16352),d=r(94170),u=r(3460);function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){(0,i.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p={id:"reactions",items:[{id:0,title:"Нравится",asset:{animation_url:"https://vk.com/reaction/3-reactions-0?c_uniq_tag=83b2081a8e4adfc36ee536f5f1b4ad470174c89678369a4b9dc5547614a3955e",images:[{url:"https://vk.com/reaction/1-reactions-0-48?c_uniq_tag=e6bee176471af6e4f7ca0f57ac099847d57b8101bf07944e47b42b097a6d8455",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-0-72?c_uniq_tag=d6f55fe94c0add8f817b447cbd804768752eb996c06ef222b39eb3fd35834780",width:72,height:72}],title:{color:{foreground:{light:"FF3347",dark:"FF5C5C"},background:{light:"FFEDED",dark:"3E2526"}}},title_color:{light:"FF3347",dark:"FF5C5C"}}},{id:1,title:"Смешно",asset:{animation_url:"https://vk.com/reaction/3-reactions-1?c_uniq_tag=a47193579880c0f53dd597a15d3bd57d4827820687c73d6128df2720647b42b9",images:[{url:"https://vk.com/reaction/1-reactions-1-48?c_uniq_tag=8f5eb3a1d6a6ec81aceff211782af3c9e9a5d1c837f0bfade6965a6844786f8b",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-1-72?c_uniq_tag=c852fcad6e67059878dcf1905e3e416fd89fbc61222ead100935a6fcc1dab4c9",width:72,height:72}],title:{color:{foreground:{light:"FF8000",dark:"FFC233"},background:{light:"FFF2D6",dark:"352E23"}}},title_color:{light:"FF8000",dark:"FFC233"}}},{id:2,title:"Ого!",asset:{animation_url:"https://vk.com/reaction/3-reactions-2?c_uniq_tag=b946fcbe262642bc920331746b6eccd9f175bb17d8ef37e54d232fa35ca2c750",images:[{url:"https://vk.com/reaction/1-reactions-2-48?c_uniq_tag=2a6544dce8827d216db7ea91eafc726cd3a823f5d465ba00216901a6de2801ad",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-2-72?c_uniq_tag=5a0663f3d38dd6fbcf3e4973610d50641420631c9df30b6cf80eee0dd5c5efee",width:72,height:72}],title:{color:{foreground:{light:"FF8000",dark:"FFC233"},background:{light:"FFF2D6",dark:"352E23"}}},title_color:{light:"FF8000",dark:"FFC233"}}},{id:3,title:"Восторг",asset:{animation_url:"https://vk.com/reaction/3-reactions-3?c_uniq_tag=c6ed3add99e841dccda5479c8e21779954e61e0fba15f94a2ae16706df492123",images:[{url:"https://vk.com/reaction/1-reactions-3-48?c_uniq_tag=eda1a2c18d733b356babdeed5f52cdcc64dd59f1f69776a133fc34a5627eecee",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-3-72?c_uniq_tag=be09c5080773a9ba78984406588c7371e48073e80b842eb7c9a817f7b435379b",width:72,height:72}],title:{color:{foreground:{light:"FF8000",dark:"FFC233"},background:{light:"FFF2D6",dark:"352E23"}}},title_color:{light:"FF8000",dark:"FFC233"}}},{id:5,title:"Печаль",asset:{animation_url:"https://vk.com/reaction/3-reactions-5?c_uniq_tag=c61122c8c334154cb10ccf0e0687057bf1f0f40c2817198b2e1150df534c22c4",images:[{url:"https://vk.com/reaction/1-reactions-5-48?c_uniq_tag=31bcb230babad96120a62589c52af22811aaba54d4ed73a36cfd499d9d94102f",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-5-72?c_uniq_tag=a840d0eb581c133d97638ff5bf34f4b33f3fb8557b932cfe3516925b88e2f151",width:72,height:72}],title:{color:{foreground:{light:"4986CC",dark:"71AAEB"},background:{light:"EDF3FA",dark:"27303C"}}},title_color:{light:"4986CC",dark:"71AAEB"}}},{id:4,title:"&$#%!",asset:{animation_url:"https://vk.com/reaction/3-reactions-4?c_uniq_tag=063e6b2dd888bb5a9716cf6153f03bf9c0c9707713b857eed8fe1e4e09aea2b3",images:[{url:"https://vk.com/reaction/1-reactions-4-48?c_uniq_tag=c80e3224c299a73384c057ff065c9458dcd533d57a1458875eb98883c3a96783",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-4-72?c_uniq_tag=a0eddba1ec31f96adbb9afa2c6c14bec055b95f8d9f113bdf759fb5a9c9054f0",width:72,height:72}],title:{color:{foreground:{light:"EF5203",dark:"FA5300"},background:{light:"FDEBE8",dark:"3C2421"}}},title_color:{light:"EF5203",dark:"FA5300"}}}]};function v(e){var t,r,i,l,v,h,m,_,g,y,b,k,w,I,C,A,P,O,S,x,E,j=f(f({},null==e||null===(t=e.attachments)||void 0===t||null===(r=t[0])||void 0===r?void 0:r.wall),{},{attachments:(A=e,S=null==A||null===(P=A.attachments)||void 0===P||null===(O=P[0])||void 0===O?void 0:O.wall,x=null==S?void 0:S.geo,E=(null==S?void 0:S.attachments)||[],x?[].concat((0,n.default)(E),[{type:"geo",geo:x}]):E)}),M=null==j||null===(i=j.copy_history)||void 0===i?void 0:i[0],D={};if(M){var T=(0,u.apiAttachWallOwnerId)(M),U="reply"===M.post_type;D=f(f({},D),U?{wallReply:{kind:"WallReply",id:M.id||0,postId:M.reply_post_id||0,authorId:s.resolveId(M.from_id),ownerId:s.resolveId(T),parentsStack:M.parents_stack,date:1e3*(M.date||0),chunks:a.fromServerText(M.text||""),attaches:(0,u.fromApiWallAttach)(M)}}:{wall:{kind:"Wall",id:M.id||0,authorId:s.resolveId(M.from_id),ownerId:s.resolveId(T),date:1e3*(M.date||0),chunks:a.fromServerText(M.text||""),attaches:(0,u.fromApiWallAttach)(M)}}),j.copy_history=void 0}null!=j&&j.attachments&&(D=f(f({},D),(0,u.fromApiWallAttach)(j)));var F=[],N=[];return p.items.forEach((function(e){var t=function(e){var t,r,n,i,o,a;if(e.asset.animation_url&&null!==(t=e.asset.title_color)&&void 0!==t&&t.dark&&null!==(r=e.asset.title_color)&&void 0!==r&&r.light){var s=null===(n=e.asset.images.find((function(e){return 48===e.height})))||void 0===n?void 0:n.url,c=null===(i=e.asset.images.find((function(e){return 72===e.height})))||void 0===i?void 0:i.url;if(s&&c)return{id:d.resolveId(e.id),animation:e.asset.animation_url,title:e.title,image48:s,image72:c,color:{light:null===(o=e.asset.title_color)||void 0===o?void 0:o.light,dark:null===(a=e.asset.title_color)||void 0===a?void 0:a.dark}}}}(e);t&&(F.push(t),N.push(t.id))})),{post:{kind:"Normal",cmid:o.resolveCmid(e.cmid),chunks:null!=j&&j.text?a.fromServerText(j.text):[],views:(null==j||null===(l=j.views)||void 0===l?void 0:l.count)||0,sentAt:1e3*e.time,updatedAt:e.update_time&&1e3*e.update_time,channelId:c.resolveId(e.author_id),likes:{count:(null==j||null===(v=j.likes)||void 0===v?void 0:v.count)||0,reactionId:Boolean(null==j||null===(h=j.likes)||void 0===h?void 0:h.user_likes)?d.resolveId(null==j||null===(m=j.reactions)||void 0===m?void 0:m.user_reaction):void 0,availableReactionIds:N,peerIds:new Set},reposts:{count:(null==j||null===(_=j.reposts)||void 0===_?void 0:_.count)||0,isReposted:Boolean(null==j||null===(g=j.reposts)||void 0===g?void 0:g.user_reposted)},comments:{count:(null==j||null===(y=j.comments)||void 0===y?void 0:y.count)||0,oneLevelCount:0,canView:Boolean(null==j||null===(b=j.comments)||void 0===b?void 0:b.can_view),canPost:Boolean(null==j||null===(k=j.comments)||void 0===k?void 0:k.can_post),history:[],order:"interesting"},attaches:D,donutPlaceholder:null!==(w=j.donut)&&void 0!==w&&w.placeholder?{text:null===(I=j.donut.placeholder)||void 0===I?void 0:I.text,button:null===(C=j.donut.placeholder)||void 0===C?void 0:C.button}:void 0},reactions:F}}},78399:(e,t,r)=>{"use strict";r.d(t,{fromApiStickerPack:()=>a,fromApiSticker:()=>s,fromApiStickersKeywords:()=>c});var n=r(78664);function i(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e){if("stickers"===e.type&&e.title&&e.previews&&e.stickers){var t=e.previews.find((function(e){return 22===e.height})),r=e.previews.find((function(e){return 34===e.height})),i=e.previews.find((function(e){return 44===e.height})),o=e.previews.find((function(e){return 68===e.height}));if(t&&r&&i&&o){var a=[],c=[];return e.stickers.reduce((function(e,t){var r=s(t);return r?(c.push(r),e.push(r.id),e):e}),a),{stickerPack:{id:n.resolveStickerPackId(e.id),name:e.title,icons:{icon22:t.url,icon34:r.url,icon44:i.url,icon68:o.url},stickerIds:a},stickers:c}}}}function s(e){var t,r;if("sticker_id"in e&&e.images&&e.images_with_background&&e.sticker_id){e.images.sort((function(e,t){return e.height-t.height}));var i=e.images.find((function(e){return e.height>=128})),o=e.images.find((function(e){return e.height>=256})),a=e.images_with_background.find((function(e){return e.height>=128})),s=e.images_with_background.find((function(e){return e.height>=256}));if(i&&o&&a&&s)return{id:n.resolveStickerId(e.sticker_id),kind:"Sticker",isAllowed:void 0===e.is_allowed||e.is_allowed,image128:{light:i.url,dark:a.url},image256:{light:o.url,dark:s.url},animation:e.animations&&{light:(null===(t=e.animations.find((function(e){return"light"===e.type})))||void 0===t?void 0:t.url)||"",dark:(null===(r=e.animations.find((function(e){return"dark"===e.type})))||void 0===r?void 0:r.url)||""}}}}function c(e){return e.dictionary.reduce((function(e,t){var r,o,a,s=null!==(r=null===(o=t.stickers)||void 0===o?void 0:o.map((function(e){var t=e.sticker_id;return n.resolveStickerId(t)})))&&void 0!==r?r:[],c=i(t.words);try{for(c.s();!(a=c.n()).done;){e[a.value]=s}}catch(e){c.e(e)}finally{c.f()}return e}),{})}},81385:(e,t,r)=>{"use strict";var n,i,o,a,s;r.d(t,{IEngine:()=>n}),i=n||(n={}),function(e){e[e.Mention=1]="Mention",e[e.ExpiringMessage=2]="ExpiringMessage"}(o||(o={})),i.MarkedType=o,function(e){e[e.CopyFlagChanged=0]="CopyFlagChanged",e[e.TitleChanged=1]="TitleChanged",e[e.AvatarChanged=2]="AvatarChanged",e[e.AdminGrated=3]="AdminGrated",e[e.FlagsChanged=4]="FlagsChanged",e[e.Pinned=5]="Pinned",e[e.UserJoined=6]="UserJoined",e[e.UserLeft=7]="UserLeft",e[e.UserKicked=8]="UserKicked",e[e.AdminKicked=9]="AdminKicked",e[e.BannerChanged=10]="BannerChanged",e[e.KeyboardChanged=11]="KeyboardChanged",e[e.MessageRequestChanged=12]="MessageRequestChanged",e[e.ContactConverted=13]="ContactConverted",e[e.BusinessNotifyDataChanged=14]="BusinessNotifyDataChanged",e[e.MessageRequestCanceled=15]="MessageRequestCanceled",e[e.MessageRequestRejected=16]="MessageRequestRejected",e[e.MessageRequestAccepted=17]="MessageRequestAccepted",e[e.ContactJoined=18]="ContactJoined",e[e.CallInProgressChanged=19]="CallInProgressChanged",e[e.DonSubscribed=20]="DonSubscribed",e[e.DonUnsubscribed=21]="DonUnsubscribed",e[e.IsNewChange=22]="IsNewChange",e[e.StyleChanged=23]="StyleChanged"}(a||(a={})),i.ChatUpdateType=a,function(e){e[e.Deleted=0]="Deleted",e[e.Accepted=1]="Accepted",e[e.Rejected=2]="Rejected",e[e.New=3]="New"}(s||(s={})),i.MRStatus=s,i.isIncompleteUpdate=function(e){switch(e[0]){case 10004:case 4:return e.length<12;case 10005:case 10018:case 5:case 18:return e.length<11;default:return!1}}},37021:(e,t,r)=>{"use strict";r.d(t,{TypingVariants:()=>h,insertConvos:()=>m,insertPeers:()=>g,insertContactItems:()=>y,insertContacts:()=>b,insertFolders:()=>k,insertChannels:()=>w,getOwnerGroupId:()=>I,removeConvosFromFolder:()=>C,addConvosToFolder:()=>A,getConvosByIds:()=>P});var n=r(9727),i=r(14432),o=r(33600),a=r(16352),s=r(60202),c=r(89032),d=r(4850),u=r(90917),l=r(19117),f=r(92954);function p(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var h=["text","voice","photo","video","file"];function m(e,t){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=i.dangerouslyMerge,s=[],d=p(t);try{for(d.s();!(r=d.n()).done;){var u,l=r.value,f="conversation"in l?(0,c.fromApiConvo)(l.conversation,l.last_message):(0,c.fromApiConvo)(l);if(f){var v=f.convo,h=f.peer,m=e.convos.get(v.peerId);if(!m||a){var g=_(v,m);e.convos.set(v.peerId,g),h&&e.peers.set(h.id,h),s.push(v),"ChatConvo"===g.kind&&e.hiddenPinnedMessages.get(g.peerId)!==(null===(u=g.pinnedMessage)||void 0===u?void 0:u.cmid)&&e.hiddenPinnedMessages.delete(g.peerId)}else s.push(m)}}}catch(e){d.e(e)}finally{d.f()}var y=s.filter((function(e){return!n.isMR(e)&&!n.isBusinessNotify(e)}));return o.add(e.convosSearchIndex,y,(function(t){var r=e.peers.get(t.peerId);return{id:t.peerId,strings:r?o.peerWords(r):[]}})),s}function _(e,t){return t?(0===t.persisted.size&&0===t.queued.size&&(t.persisted=e.persisted,t.persistedCmid=e.persistedCmid),t):e}function g(e,t){var r,n=t.apiUsers,i=t.apiGroups,o=t.apiContacts,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=a.dangerouslyOverwrite,c=[],u=p(n);try{for(u.s();!(r=u.n()).done;){var l=r.value,f=(0,d.fromApiUser)(l),v=f.user,h=f.isOnline,m=e.peers.get(v.id);!m||"User"!==m.kind||s?(e.peers.set(v.id,v),s&&e.onlines.delete(v.id),h&&e.onlines.add(v.id),c.push(v)):c.push(m)}}catch(e){u.e(e)}finally{u.f()}var _,g=[],y=p(i);try{for(y.s();!(_=y.n()).done;){var b=_.value,k=(0,d.fromApiGroup)(b),w=e.peers.get(k.id);!w||"Group"!==w.kind||s?(e.peers.set(k.id,k),g.push(k)):g.push(w)}}catch(e){y.e(e)}finally{y.f()}var I,C=[],A=p(o);try{for(A.s();!(I=A.n()).done;){var P=I.value,O=(0,d.fromApiContact)(P),S=e.peers.get(O.id);!S||"Contact"!==S.kind||s?(e.peers.set(O.id,O),C.push(O)):C.push(S)}}catch(e){A.e(e)}finally{A.f()}return{insertedUsers:c,insertedGroups:g,insertedContacts:C}}function y(e,t,r){var n=[];return g(e,{apiUsers:r,apiGroups:[],apiContacts:[]},{dangerouslyOverwrite:!0}),t.forEach((function(t){var r=i.resolveId(t);if(i.isUserPeerId(r)){var o=e.peers.get(r);if("User"!==(null==o?void 0:o.kind))return;e.contacts.items.set(r,o),n.push(r)}})),n}function b(e,t){var r=[];t.sort((function(e,t){return e.name.localeCompare(t.name)}));var n,i=p(t);try{for(i.s();!(n=i.n()).done;){var o=n.value,a=(0,d.fromApiContact)(o),s=a.userId?a.userId:a.id;e.contacts.contacts.set(s,a),r.push(a)}}catch(e){i.e(e)}finally{i.f()}return r}function k(e,t){var r,n=[],i=p(t);try{var o=function(){var t=r.value,i=(0,u.fromApiFolder)(t);if(e.organisers.folders.find((function(e){return e.id===i.id})))return n.push(i),"continue";e.organisers.folders.push(i),n.push(i)};for(i.s();!(r=i.n()).done;)o()}catch(e){i.e(e)}finally{i.f()}return n}function w(e,t){var r,n=t.apiChannels,i=t.apiGroups,o=t.dangerouslyMerge,s=[],c=p(n||[]);try{var d=function(){var t=r.value,n=i.find((function(e){return-e.id===t.channel.channel_id}));if(!n)throw new Error("С бэка не приходит нужная группа для канала");var c=(0,l.fromApiChannel)(t,n);(t.last_message&&(0,f.fromApiPost)(t.last_message).reactions||[]).forEach((function(t){e.reactions.set(t.id,t)}));var d=e.channels.get(c.id);if(d&&!o)return s.push(d),"continue";var u=d?a.merge(d,c):c;e.channels.set(u.id,u),s.push(u)};for(c.s();!(r=c.n()).done;)d()}catch(e){c.e(e)}finally{c.f()}return s}function I(e){return i.isGroupPeerId(e)?i.toRealId(e):0}function C(e,t,r){var i,o,a=e.organisers.folders.find((function(e){return e.id===t}));if(a){var c,d=null!==(i=a.unreadCount)&&void 0!==i?i:0,u=null!==(o=a.unreadUnmutedCount)&&void 0!==o?o:0,l=p(r);try{for(l.s();!(c=l.n()).done;){var f=c.value;n.isInFolder(f,t)&&(n.removeFolder(f,t),s.refresh(e.organisers.folders,f),f.unreadCount&&(n.isMuted(f)?d--:u--))}}catch(e){l.e(e)}finally{l.f()}s.setUnreadCounters(e.organisers.folders,t,d,u)}}function A(e,t,r){var i,o,a=[],c=e.organisers.folders.find((function(e){return e.id===t}));if(c){var d,u=null!==(i=c.unreadCount)&&void 0!==i?i:0,l=null!==(o=c.unreadUnmutedCount)&&void 0!==o?o:0,f=p(r);try{for(f.s();!(d=f.n()).done;){var v=d.value;n.isInFolder(v,t)||(n.addFolder(v,t),a.push(v),v.unreadCount&&(n.isMuted(v)?u++:l++))}}catch(e){f.e(e)}finally{f.f()}s.push(e.organisers.folders,t,"all",a,c.all.hasMore),s.push(e.organisers.folders,t,"unread",a.filter((function(e){return n.isUnread(e)})),c.unread.hasMore),s.setUnreadCounters(e.organisers.folders,t,u,l)}}function P(e,t){return t.reduce((function(t,r){var n=e.convos.get(i.resolveId(r));return n&&t.push(n),t}),[])}}}]);try{stManager.done("dist/b5d48e03a4dc005738790e7aca8143ff.2be7c72b30a609c955e7.js")}catch(e){}